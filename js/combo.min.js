/* 20181214 */

SB=function(){"use strict";return{version:20170320,isChildOf:function(e,t){if(t===e)return!1;for(;e&&e!==t&&e!==document.body;)e=e.parentNode;return e===t},event:{list:[],add:function(e,t,i,n){n=n||!1,e.addEventListener?e.addEventListener(t,i,n):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i,SB.event.list.push([e,t,i])},remove:function(e,t,i,n){n=n||!1;var s=0;for(e.removeEventListener?e.removeEventListener(t,i,n):e.detachEvent?e.detachEvent("on"+t,i):e["on"+t]=null;s<SB.event.list.length;s+=1)if(SB.event.list[s]&&SB.event.list[s]&&SB.event.list[s][0]===e&&SB.event.list[s][1]===t&&SB.event.list[s][2]===i){SB.event.list.splice(s,1);break}},removeAll:function(e){e=e||document;for(var t=SB.event.list.length-1;0<=t;t-=1)SB.event.list[t]&&(SB.event.list[t][0]!==e&&e!==document||SB.event.remove(SB.event.list[t][0],SB.event.list[t][1],SB.event.list[t][2]))}},getTarget:function(e){return(e=e||window.event).target?e.target:e.srcElement},hasAttribute:function(e,t,i){if(e[t])return!!e[t].match(new RegExp("(\\s|^)"+i+"(\\s|$)"))},hasClass:function(e,t){var i=!1;return e&&e.className&&(i=!!SB.hasAttribute(e,"className",t)),i},addClass:function(e,t){e&&t&&(SB.hasClass(e,t)||(e.className=SB.trim(e.className+" "+t)))},removeClass:function(e,t){SB.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," "),e.className=SB.trim(e.className))},toggleClass:function(e,t){SB.hasClass(e,t)?SB.removeClass(e,t):SB.addClass(e,t)},setFocus:function(e){"function"==typeof e.setActive?e.setActive():"function"==typeof e.focus&&e.focus()},get:function(e){return document.getElementById(e)},getByTag:function(e,t){return(t=t||document).getElementsByTagName(e)},getByClass:function(e,t,i){var n=[],s=[],o=0,a=0;if(t=t||document,"*"===(i=i.toLowerCase()||"*")&&document.getElementsByClassName)return t.getElementsByClassName(e);if(t.getElementsByClassName)if(s=t.getElementsByClassName(e),i&&s.length)for(o in s)s[o].tagName&&s[o].tagName.toLowerCase()===i&&(n[a]=s[o],a+=1);else n=s;else for(o in s=SB.getByTag(i,t))SB.hasClass(s[o],e)&&(n[a]=s[o],a+=1);return n},getText:function(e){return e.textContent?e.textContent:e.innerText?e.innerText:e.text?e.text:e.innerHTML},putText:function(e,t){e.textContent?e.textContent=t:e.innerText?e.innerText=t:e.text?e.text=t:e.innerHTML=t},trim:function(e){return(e=e||"").toString().replace(/^\s\s*/,"").replace(/\s\s*$/,"")},decode:function(e){var t="";return"object"==typeof JSON&&(t=JSON.parse(e)),t},encode:function(e){var t="";return"object"==typeof JSON&&(t=JSON.stringify(e)),t},log:function(e,t,i){var n=new Date,s="color: white";if("object"==typeof console&&"function"==typeof console.log)if(t&&"object"!=typeof e){switch(e="%c"+t+"%c: "+e+" ("+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()+")",i){case"success":s="color: green";break;case"info":s="color: aqua";break;case"error":s="color: red"}console.log(e,"background: black; "+s,"background: black; color: white")}else console.log(e)},vibrate:function(e){e=e||20,window.navigator&&window.navigator.vibrate?window.navigator.vibrate(e):SB.log("Not supported","Vibrate","error")},notify:function(e,t,i){var n,s;return"function"==typeof Notification&&("granted"===Notification.permission?(n=new Notification(e,t),setTimeout(function(){n.close(),SB.event.remove(n,"click",s)},1e4),s=function(e){window.focus(),i(e),SB.event.remove(n,"click",s)},SB.event.add(n,"click",s)):SB.notifyAsk()),n},notifyAsk:function(){"function"==typeof Notification&&"denied"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)})},sound:{sounds:{},play:function(e){"function"==typeof Audio&&(SB.sound.sounds[e]||(SB.sound.sounds[e]=new Audio(e)),SB.sound.sounds[e].play())}},speak:function(e,t,i){var n,s;window.speechSynthesis?(n=new SpeechSynthesisUtterance,s=window.speechSynthesis.getVoices(),n.text=e,n.lang=t||"en-US",s&&s[10]&&"Alex"===s[10].name&&(n.voice=s[10],"female"===i&&(n.voice=s[30])),window.speechSynthesis.speak(n)):SB.log("Not supported","Speak","error")},transcribe:function(t){var i,n,e=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||null;return e?(SB.log("Supported","Transcribe","info"),i=new e,n=function(e){t(e.results[0][0].transcript,e.results[0][0].confidence),SB.event.remove(i,"result",n)},SB.event.add(i,"result",n)):SB.log("Not supported","Transcribe","error"),i},storage:function(e,t){var i;return e&&("undefined"!=typeof localStorage?(void 0!==t&&("object"==typeof t&&(t=SB.encode(t)),localStorage.setItem(e,t)),i=localStorage.getItem(e)):SB.log("Not supported","Local Storage","error")),i},ajax:{request:function(e){e.method=e.method||"GET",e.onStart=e.onStart||function(){},e.onComplete=e.onComplete||function(){};var t,i,n="?";if(i=function(){switch(e.onStart(),typeof e.onComplete){case"object":e.onComplete.value?e.onComplete.value=e.response:e.onComplete.childNodes[0]&&SB.putText(e.onComplete,e.response);break;case"function":e.onComplete()}},window.XMLHttpRequest)t=new XMLHttpRequest;else{if(!window.ActiveXObject)return!1;t=new ActiveXObject("Microsoft.XMLHTTP")}"GET"===e.method&&(-1===e.path.indexOf("?")&&-1===e.param.indexOf("?")||(n="&"),e.path=e.path+n+e.param,e.param=""),t.open(e.method.toUpperCase(),e.path,!0),"POST"===e.method&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("rest","true"),SB.event.add(t,"readystatechange",function(){if(4===t.readyState){if(200!==t.status)return!1;e.response=t.responseText,i()}}),t.send(e.param)}},init:function(){SB.spec&&SB.spec.init&&SB.spec.init(),SB.addClass(document.body,"rich")}}}(),document.addEventListener&&document.addEventListener("DOMContentLoaded",SB.init,!1),SB.event.add(window,"load",function(){"use strict";document.addEventListener||SB.init()}),SB.event.add(window,"unload",function(){"use strict";SB.event.removeAll()}),"object"==typeof module&&(module.exports=SB),SB.spec=function(){"use strict";return{version:20170414,state:{},parsers:{},templates:{},strings:{},socket:{},uiComponents:{header:{},body:{},indicator:{},templates:[]},ariaDevice:function(){var e=SB.getByClass("selected",SB.spec.uiComponents.header,"li")[0],t=SB.getByTag("h2",SB.spec.uiComponents.header)[0],i=SB.spec.strings.CURRENT.split("{{DEVICE}}").join(SB.getText(e));SB.putText(t,i),i=null},navChange:function(e){var t=SB.getByClass(e,SB.spec.uiComponents.header,"li")[0],i=SB.get(e),n=SB.getByClass("selected",SB.spec.uiComponents.header,"li")[0],s=SB.getByClass("selected",SB.spec.uiComponents.body,"section")[0];t&&!SB.hasClass(t,"selected")&&(SB.removeClass(n,"selected"),SB.removeClass(s,"selected"),SB.spec.lazyLoad(e),SB.storage("selected",e),SB.addClass(t,"selected"),SB.addClass(i,"selected"),SB.spec.lazyUnLoad(s),SB.spec.ariaDevice())},updateTemplate:function(e){var t,i,n,s,o,a=SB.get(e.deviceId),r=SB.spec.parsers[e.typeClass],l=e.value,c=e.state,p=document.createElement("div"),u=!1;return SB.spec.state[e.deviceId]=e,SB.log("Updated",e.deviceId,"success"),a&&(n=SB.spec.uiComponents.templates[e.typeClass].markup,i=SB.hasClass(a,"selected")?" selected":"",s=a.cloneNode(!0),(t=SB.getByTag("h1",s)[0]).parentNode.removeChild(t),o=s.innerHTML,r&&(n=r(e.deviceId,n,c,l,SB.spec.uiComponents.templates[e.typeClass].fragments)),"ok"===c?(n=n.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.ACTIVE),SB.hasClass(a,"device-off")&&(SB.removeClass(a,"device-off"),SB.addClass(a,"device-on"),SB.putText(SB.getByTag("em",SB.getByTag("h1",a)[0])[0],SB.spec.strings.ACTIVE))):(n=n.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.INACTIVE),SB.hasClass(a,"device-on")&&(SB.removeClass(a,"device-on"),SB.addClass(a,"device-off"),SB.putText(SB.getByTag("em",SB.getByTag("h1",a)[0])[0],SB.spec.strings.INACTIVE))),a&&n&&e&&(SB.storage("state",SB.spec.state),n=(n=(n=n.split("{{DEVICE_ID}}").join(e.deviceId)).split("{{DEVICE_TYPE}}").join(e.typeClass)).split("{{DEVICE_SELECTED}}").join(i),n="ok"===e.state?n.split("{{DEVICE_STATE}}").join(" device-on"):n.split("{{DEVICE_STATE}}").join(" device-off"),n=i?n.split("{{LAZY_LOAD_IMAGE}}").join("src"):n.split("{{LAZY_LOAD_IMAGE}}").join("data-src")),n&&(p.innerHTML=n,p=SB.getByTag("section",p)[0],(t=SB.getByTag("h1",p)[0]).parentNode.removeChild(t),p.innerHTML!==o&&(a.outerHTML=n,u=!0))),o=s=p=n=i=t=c=l=r=a=null,u},buildIndicator:function(){var e;SB.get("indicator")||((e=document.createElement("span")).id="indicator",SB.addClass(e,"connecting"),SB.putText(e,SB.spec.strings.CONNECTING),SB.spec.uiComponents.indicator=e,SB.spec.uiComponents.header.appendChild(e))},checkConnection:function(){var e=SB.spec.socket.readyState<=1;return e||(SB.spec.socketConnect(0),e=SB.spec.socket.readyState<=1),e},socketConnect:function(t){var e,i,n,s,o,a="https:"===window.location.protocol?"wss":"ws";SB.spec.socket.readyState&&3!==SB.spec.socket.readyState||(SB.log("Connecting","WebSocket","info"),SB.spec.socket=new WebSocket(a+"://"+window.location.host,"echo-protocol"),t+=1,e=function(){var e=Math.round(Math.min(Math.max(t*(15*Math.random()),10),60));SB.log("Retrying in "+e+"s","WebSocket","info"),SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED),setTimeout(function(){SB.spec.socketConnect(t)},1e3*e)}),i=function(){var e="disconnected"===SB.spec.uiComponents.indicator.className;SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),SB.log("Connected","WebSocket","success"),e&&(SB.spec.socket.send("fetch state"),SB.log("Reconnected","WebSocket","success"))},n=function(e){var t,i=SB.decode(e.data),n={};if("string"==typeof i.speech)i.speech&&(SB.log(i.speech,"Speech","success"),SB.speak(i.speech,i.language,i.voice));else if("string"==typeof i.sound)SB.log(i.sound,"Sound","success"),SB.sound.play("/mp3/"+i.sound+".mp3");else if("string"==typeof i.vibrate)SB.log(i.vibrate,"Vibrate","success"),SB.vibrate(100*i.vibrate);else if("string"==typeof i.title)t=function(){i.deviceId&&SB.spec.navChange(i.deviceId)},SB.notify(i.title,i.options,t);else if("string"==typeof i.deviceId)SB.spec.updateTemplate(i);else if("object"==typeof i){for(n in i)if(i.hasOwnProperty(n))break;if(i[n]&&i[n].deviceId)for(n in SB.log("Received","State","success"),i)i.hasOwnProperty(n)&&SB.spec.updateTemplate(i[n]);else i[n]&&i[n].markup&&(SB.spec.uiComponents.templates=i,SB.storage("templates",SB.spec.uiComponents.templates))}},s=function(){SB.event.remove(SB.spec.socket,"close",s),SB.log("Disconnected","WebSocket","error"),e()},o=function(){SB.event.remove(SB.spec.socket,"open",i),SB.event.remove(SB.spec.socket,"message",n),SB.event.remove(SB.spec.socket,"close",s),SB.event.remove(SB.spec.socket,"error",o)},SB.event.add(SB.spec.socket,"open",i),SB.event.add(SB.spec.socket,"message",n),SB.event.add(SB.spec.socket,"close",s),SB.event.add(SB.spec.socket,"error",o)},statePoller:function(){var e;SB.log("not supported - using polling","WebSockets","error"),e={path:"/templates/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){SB.spec.uiComponents.templates=SB.decode(e.response),SB.storage("templates",SB.spec.uiComponents.templates)}},SB.ajax.request(e),setInterval(function(){var i={path:"/state/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){var e,t=SB.decode(i.response);if(t)for(e in SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),setTimeout(function(){SB.spec.uiComponents.indicator.className="connecting",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTIG)},1e3),t)t.hasOwnProperty(e)&&SB.spec.updateTemplate(t[e]);else SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED)}};SB.ajax.request(i)},1e4)},lazyLoad:function(e){var t,i,n,s,o=0;if(SB.get(e))for(t=SB.get(e),i=Array.prototype.slice.call(SB.getByTag("img",t)),n=Array.prototype.slice.call(SB.getByTag("iframe",t)),s=i.concat(n);o<s.length;o+=1)s[o].getAttribute("data-src")&&!s[o].src&&(s[o].src=s[o].getAttribute("data-src"))},lazyUnLoad:function(e){var t,i,n,s=0;if(e)for(t=Array.prototype.slice.call(SB.getByTag("img",e)),i=Array.prototype.slice.call(SB.getByTag("iframe",e)),n=t.concat(i),s=0;s<n.length;s+=1)n[s].getAttribute("src")&&(SB.hasClass(n[s],"streaming")||"IFRAME"===n[s].tagName)&&(n[s].setAttribute("data-src",n[s].src),n[s].removeAttribute("src"))},openModal:function(e){var t,i,n,s,o,a=e.getAttribute("data-modal-container"),r=SB.get(a),l=e.getAttribute("title"),c=e.href,p=c.split(".").pop(),u=SB.getByClass("close-modal",r,"a")||[];switch(u.length&&this.closeModal(u[0]),p.toLowerCase()){case"jpg":case"jpeg":case"gif":case"png":(t=document.createElement("img")).src=c,t.alt=l;break;case"mkv":case"mp4":case"ogg":(t=document.createElement("video")).src=c,t.title=l,t.setAttribute("controls",""),t.setAttribute("autoplay",""),t.setAttribute("type","video/mp4");break;case"mp3":(t=document.createElement("video")).src=c,t.title=l,t.setAttribute("controls",""),t.setAttribute("autoplay",""),t.setAttribute("type","audio/mp3")}t&&((i=document.createElement("div")).className="curtain",i.setAttribute("data-modal-container",a),(n=document.createElement("div")).className="modal",(s=document.createElement("a")).className="close-modal fa fa-close device-active",s.href="#",s.title=SB.spec.strings.CLOSE,s.setAttribute("data-modal-container",a),o=document.createElement("span"),SB.putText(o,SB.spec.strings.CLOSE),s.appendChild(o),n.appendChild(s),n.appendChild(t),i.appendChild(n),r.appendChild(i),setTimeout(function(){s.focus()},10))},closeModal:function(e){var t=SB.get(e.getAttribute("data-modal-container"));t.removeChild(SB.getByClass("curtain",t,"div")[0])},command:function(i){var s=null,t=0,n=750,o=!1,a=!1,r=!1,l=!0,c=0,p=0,u=function(){s=null,n=750,l=!(a=!(r=!(t=0))),p=c=0},S=function(e){var t=s;SB.vibrate(),i||SB.spec.sendTextInput(e,t,"text"),u()},E=function(e){var t=SB.getTarget(e),i=t.tagName.toLowerCase(),n=null;return t="img"===i?t.parentNode:t,t="i"===i?t.parentNode:t,"a"===(t="span"===i?t.parentNode:t).tagName.toLowerCase()?n=t:"curtain"===t.className&&(n=t),n},d=function(){var e;s&&!r&&(SB.vibrate(),i?SB.log("Issued","Demo Command","success"):SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Command","success"),SB.spec.socket.send(s)):(e={path:s,param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){SB.log(e.response)}},SB.ajax.request(e)),3<t&&(n=650),10<t&&(n=500),t+=1,setTimeout(d,n))},B=function(e,t){var i,n=E(e);t?(SB.vibrate(),s=SB.getTarget(e).parentNode.parentNode.id,SB.transcribe(S).start()):n&&!r&&("external"===n.rel?((i=window.open()).opener=null,i.location=n.href):SB.hasClass(n,"modal")?SB.spec.openModal(n):SB.hasClass(n,"close-modal")||SB.hasClass(n,"curtain")?SB.spec.closeModal(n):(s=n.href,d()))};"ontouchstart"in document.documentElement&&(SB.log("Enabled","Touch Events","info"),SB.event.add(SB.spec.uiComponents.body,"touchstart",function(e){l=!(a=o=!0),E(e)&&(r=!1,c=parseInt(e.changedTouches[0].clientX,10),p=parseInt(e.changedTouches[0].clientY,10),setTimeout(function(){l||(o=!1,B(e))},450))}),SB.event.add(SB.spec.uiComponents.body,"contextmenu",function(e){e.preventDefault()}),SB.event.add(SB.spec.uiComponents.body,"touchend",function(e){!SB.hasClass(SB.getTarget(e).parentNode,"emoji")&&o&&(l=!0,B(e)),u()}),SB.event.add(SB.spec.uiComponents.body,"touchmove",function(e){a&&(5<Math.abs(parseInt(e.changedTouches[0].clientX,10)-c)||5<Math.abs(parseInt(e.changedTouches[0].clientY,10)-p))&&u()}),SB.event.add(SB.spec.uiComponents.body,"touchcancel",function(e){u()})),SB.event.add(SB.spec.uiComponents.body,"mousedown",function(e){SB.hasClass(SB.getTarget(e).parentNode,"emoji")?B(e,!0):!1===a&&!1===o&&(r=!1,B(e)),o=!1}),SB.event.add(SB.spec.uiComponents.body,"mouseup",function(e){SB.hasClass(SB.getTarget(e).parentNode,"emoji")||u()}),SB.event.add(SB.spec.uiComponents.body,"click",function(e){E(e)&&e.preventDefault()}),SB.event.add(SB.spec.uiComponents.body,"keyup",function(e){13===e.keyCode&&E(e)&&(r=!1,B(e),setTimeout(function(){r=!0},n/2))})},sendInput:function(e){var t=SB.getByTag("input",e,"input")[0],i=t.value,n=t.name,s=SB.getByClass("input-type",e,"input")[0].value;"text"===t.type&&(t.value=""),SB.spec.sendTextInput(i,n,s)},sendTextInput:function(e,t,i){var n;i=i||"text",SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Text Command","success"),SB.spec.socket.send("/?"+t+"="+i+"-"+e)):(n={path:"/",param:t+"="+i+"-"+e+"&ts="+(new Date).getTime(),method:"POST",onComplete:function(){SB.log(n.response)}},SB.ajax.request(n))},formInput:function(o){SB.event.add(SB.spec.uiComponents.body,"submit",function(e){var t=SB.getTarget(e);e.preventDefault(),o?SB.log("Issued","Demo Text Command","success"):SB.spec.sendInput(t)}),SB.event.add(SB.spec.uiComponents.body,"change",function(e){var t,i,n=SB.getTarget(e),s=n.type;("range"===s||"number"===s&&void 0!==n.max&&void 0!==n.min)&&("range"===s?"number"===(i=n.previousElementSibling).type&&(i.value=n.value):"number"===s&&"range"===(t=n.nextElementSibling).type&&(t.value=n.value),o?SB.log("Issued","Demo Form Command","success"):SB.spec.sendInput(n.form))})},nav:function(){SB.event.add(SB.spec.uiComponents.header,"click",function(e){var t=SB.getTarget(e).parentNode;"li"===t.tagName.toLowerCase()?(e.preventDefault(),SB.spec.navChange(t.className),SB.vibrate(),SB.notifyAsk()):"indicator"===SB.getTarget(e).id&&SB.hasClass(SB.getTarget(e),"disconnected")&&SB.spec.socketConnect(0)})},init:function(){var e,t,i,n=SB.storage("selected"),s=SB.storage("templates"),o=SB.storage("state");if(SB.spec.uiComponents.header=SB.getByTag("header")[0],SB.spec.uiComponents.body=SB.getByTag("main")[0],SB.spec.buildIndicator(),t=SB.spec.uiComponents.header.dataset,i=SB.spec.uiComponents.body.dataset,SB.spec.strings={CURRENT:t.stringCurrent,CONNECTED:t.stringConnected,CONNECTING:t.stringConnecting,DISCONNECTED:t.stringDisconnected,ACTIVE:i.stringActive,INACTIVE:i.stringInactive,ON:i.stringOn,OFF:i.stringOff,CLOSE:i.stringClose,AM:i.stringAm,PM:i.stringPm,SUN:i.stringSun,MON:i.stringMon,TUE:i.stringTue,WED:i.stringWed,THUR:i.stringThur,FRI:i.stringFri,SAT:i.stringSat},n&&SB.spec.navChange(n),s&&o)for(e in SB.spec.uiComponents.templates=SB.decode(s),o=SB.decode(o))o.hasOwnProperty(e)&&SB.spec.updateTemplate(o[e]);"function"==typeof WebSocket||"object"==typeof WebSocket?SB.spec.socketConnect(0):SB.spec.statePoller(),SB.spec.lazyLoad(n||document.body.className),SB.spec.command(!1),SB.spec.formInput(!1),SB.spec.nav(),SB.spec.ariaDevice()}}}(),function(e){"use strict";e.activeBuilding=function(e,t,i,n,s){var o,a="",r="",l="",c="",p=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"activeBuilding"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"activeBuilding",s)};return i&&n&&(o=n,c="object"==typeof SB&&"object"==typeof SB.util?SB.util.arrayList(o,"activeBuilding",s):require(__dirname+"/../../lib/sharedUtil").util.arrayList(o,"activeBuilding",s)),n&&0!==n.length?1===n.length?(r="ok",l="tag",a=p("SINGLE_PACKAGE")):1<n.length&&(r="ok",l="tags",a=p("PLURAL_PACKAGES")):(r="err",l="times",a=p("NO_PACKAGES")),a=a.split("{{SENDERS}}").join(c),t=(t=(t=t.replace("{{ACTIVEBUILDING_STATE}}",r)).replace("{{ACTIVEBUILDING_ICON}}",l)).replace("{{ACTIVEBUILDING_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.airQuality=function(e,t,i,n,s){var o,a=s.report,r=s.graph,l=0,c="",p="",u="";if(n)for(l in c=n.location,n.report)n.report.hasOwnProperty(l)&&(u="",(o=n.report[l].max)&&(u=(u=r.split("{{MAX_VALUE}}").join(o)).split("{{PERCENT_QUALITY}}").join(Math.round(n.report[l].value/o*100))),p=(p=(p=(p=(p+=a.split("{{AIR_QUALITY_GRAPH}}").join(u)).split("{{AIR_QUALITY_TYPE}}").join(n.report[l].type)).split("{{AIR_QUALITY_VALUE}}").join(n.report[l].value)).split("{{AIR_QUALITY_UNITS}}").join(n.report[l].units)).split("{{AIR_QUALITY_HIGH}}").join(n.report[l].high));return(t=t.replace("{{AIR_QUALITY_LOCATION}}",c)).replace("{{AIR_QUALITY_DYNAMIC}}",p)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.debug=function(e,t,i,n,s,o){var a,r=(new Date).getTime(),l="",c="",p=0,u=0,S=0,E=0,d=0,B=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"debug"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"debug",o)},f=function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayRelativeTime(e):require(__dirname+"/../../lib/sharedUtil").util.displayRelativeTime(e)},T=B("NA");return n&&(l=f(n.uptime),c=f((r-n.startup)/1e3),p=n.memoryUsed,u=n.totalMemory,S=n.percentMemory,E=Math.round(100*n.cpuLoad[0]),d=n.clientCount,T=n.temperature?n.temperature:T),t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("{{DEBUG_UPDATE}}",(a=r,"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(a,B):require(__dirname+"/../../lib/sharedUtil").util.displayTime(a,B)))).replace("{{DEBUG_UPTIME}}",l)).replace("{{DEBUG_RUNTIME}}",c)).replace("{{DEBUG_MEMORY_USED}}",p)).replace("{{DEBUG_SYSTEM_MEMORY}}",u)).replace("{{DEBUG_MEMORY_PERCENT}}",S)).replace("{{DEBUG_CPU}}",E)).replace("{{DEBUG_CLIENT_TEMP}}",T)).replace("{{DEBUG_CLIENT_COUNT}}",d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.denon=function(e,t,i,n){return n&&(t=t.split("{{DEVICE_POWER}}").join(n.power),n.ZONE1&&(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_Z1_INPUT}}").join(n.ZONE1.input)).split("{{DEVICE_Z1_POWER}}").join(n.ZONE1.power)).split("{{DEVICE_Z1_MUTE}}").join(n.ZONE1.mute)).split("{{DEVICE_Z1_MODE}}").join(n.ZONE1.mode)).split("{{DEVICE_Z1_VOLUME}}").join(n.ZONE1.volume)).split("{{DEVICE_Z1_MAXVOLUME}}").join(n.ZONE1.maxvolume)),n.ZONE2&&(t=(t=(t=t.split("{{DEVICE_Z2_POWER}}").join(n.ZONE2.power)).split("{{DEVICE_Z2_INPUT}}").join(n.ZONE2.input)).split("{{DEVICE_Z2_VOLUME}}").join(n.ZONE2.volume)),n.ZONE3&&(t=(t=(t=t.split("{{DEVICE_Z3_POWER}}").join(n.ZONE3.power)).split("{{DEVICE_Z3_INPUT}}").join(n.ZONE3.input)).split("{{DEVICE_Z3_VOLUME}}").join(n.ZONE3.volume))),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_POWER}}").join("")).split("{{DEVICE_Z1_POWER}}").join("")).split("{{DEVICE_Z1_INPUT}}").join("")).split("{{DEVICE_Z1_MUTE}}").join("")).split("{{DEVICE_Z1_MODE}}").join("")).split("{{DEVICE_Z1_VOLUME}}").join("")).split("{{DEVICE_Z1_MAXVOLUME}}").join("")).split("{{DEVICE_Z2_POWER}}").join("")).split("{{DEVICE_Z2_INPUT}}").join("")).split("{{DEVICE_Z2_VOLUME}}").join("")).split("{{DEVICE_Z3_POWER}}").join("")).split("{{DEVICE_Z3_INPUT}}").join("")).split("{{DEVICE_Z3_VOLUME}}").join("")}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.dLinkCamera=function(e,t,i,n,s,o){var a,r,l,c,p,u,S,E=s.photo,d=s.photos,B=s.video,f=s.videos,T=s.thumb,_="",C="",m="",g="",A="",I=0,v=0,h=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"dLinkCamera"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"dLinkCamera",o)};if("on"===(n=n||{}).alarm?(_=" device-active",m=h("CAMERA_ARMED")):"off"===n.alarm&&(C=" device-active",m=h("CAMERA_DISARMED")),t=(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_STATE_ON}}").join(_)).split("{{DEVICE_STATE_OFF}}").join(C)).split("{{ARMED_STATUS}}").join(m)).split("{{DISARMED_STATUS}}").join(m)).split("{{SCREENSHOT}}").join(h("SCREENSHOT"))).split("{{THUMBNAIL}}").join(h("THUMBNAIL"))).split("{{VIDEO}}").join(h("VIDEO")),n.photos&&n.photos.length){for(;I<n.photos.length;I+=1)g=(g+=E.split("{{PHOTO_NAME}}").join(n.photos[I].name)).split("{{PHOTO_URL}}").join(n.photos[I].photo);g=(g=g.split("{{PHOTO}}").join(h("PHOTO"))).split("{{DEVICE_ID}}").join(e),g=d.split("{{DLINKCAMERA_PHOTOS}}").join(g),t=t.split("{{DLINKCAMERA_PHOTO_LIST}}").join(g)}if(t=t.split("{{DLINKCAMERA_PHOTO_LIST}}").join(""),n.videos&&n.videos.length){for(;v<n.videos.length;v+=1)(S=n.videos[v].thumb||"")&&(A=(A=A.split("{{VIDEO_THUMB}}").join(T)).split("{{THUMB_URL}}").join(S)),A=(A=(A+=B.split("{{VIDEO_NAME}}").join(n.videos[v].name)).split("{{SCREEN_URL}}").join(n.videos[v].screen)).split("{{VIDEO_URL}}").join(n.videos[v].video);A=(A=(A=(A=(A=A.split("{{VIDEO_THUMB}}").join("")).split("{{SCREENSHOT}}").join(h("SCREENSHOT"))).split("{{THUMBNAIL}}").join(h("THUMBNAIL"))).split("{{VIDEO}}").join(h("VIDEO"))).split("{{DEVICE_ID}}").join(e),A=f.split("{{DLINKCAMERA_VIDEOS}}").join(A),t=t.split("{{DLINKCAMERA_VIDEO_LIST}}").join(A)}return t=t.split("{{DLINKCAMERA_VIDEO_LIST}}").join(""),"object"==typeof SB&&(c=SB.getByClass("image-list",SB.get(e),"div")[0],l=SB.getByTag("ol",c)[0],u=SB.getByClass("video-list",SB.get(e),"div")[0],p=SB.getByTag("ol",u)[0],t=t.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),a=SB.getByClass("fa-lock",SB.get(e),"a")[0],r=SB.getByClass("fa-unlock",SB.get(e),"a")[0],l&&g!==l.outerHTML&&c.removeChild(l),!n.photos||l&&g===l.outerHTML||(g=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?g.split("{{LAZY_LOAD_IMAGE}}").join("src"):g.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),c.innerHTML=g),p&&A!==p.outerHTML&&u.removeChild(p),!n.videos||p&&A===p.outerHTML||(A=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?A.split("{{LAZY_LOAD_IMAGE}}").join("src"):A.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),u.innerHTML=A),"on"!==n.alarm||SB.hasClass(a,"device-on")?"off"!==n.alarm||SB.hasClass(r,"device-on")||(SB.addClass(r,"device-active"),SB.removeClass(a,"device-active"),SB.putText(SB.getByTag("em",a)[0],m),SB.putText(SB.getByTag("em",r)[0],m),t=""):(SB.addClass(a,"device-active"),SB.removeClass(r,"device-active"),SB.putText(SB.getByTag("em",a)[0],m),SB.putText(SB.getByTag("em",r)[0],m),t="")),t}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.foscam=function(e,t,i,n,s,o){var a,r,l,c,p,u,S,E=s.photo,d=s.photos,B=s.video,f=s.videos,T=s.thumb,_="",C="",m="",g="",A="",I=0,v=0,h=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"foscam"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"foscam",o)};if("on"===(n=n||{}).alarm?(_=" device-active",m=h("CAMERA_ARMED")):"off"===n.alarm&&(C=" device-active",m=h("CAMERA_DISARMED")),t=(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_STATE_ON}}").join(_)).split("{{DEVICE_STATE_OFF}}").join(C)).split("{{ARMED_STATUS}}").join(m)).split("{{DISARMED_STATUS}}").join(m)).split("{{SCREENSHOT}}").join(h("SCREENSHOT"))).split("{{THUMBNAIL}}").join(h("THUMBNAIL"))).split("{{VIDEO}}").join(h("VIDEO")),n.photos&&n.photos.length){for(;I<n.photos.length;I+=1)g=(g+=E.split("{{PHOTO_NAME}}").join(n.photos[I].name)).split("{{PHOTO_URL}}").join(n.photos[I].photo);g=(g=g.split("{{PHOTO}}").join(h("PHOTO"))).split("{{DEVICE_ID}}").join(e),g=d.split("{{FOSCAM_PHOTOS}}").join(g),t=t.split("{{FOSCAM_PHOTO_LIST}}").join(g)}if(t=t.split("{{FOSCAM_PHOTO_LIST}}").join(""),n.videos&&n.videos.length){for(;v<n.videos.length;v+=1)(S=n.videos[v].thumb||"")&&(A=(A=A.split("{{VIDEO_THUMB}}").join(T)).split("{{THUMB_URL}}").join(S)),A=(A=(A+=B.split("{{VIDEO_NAME}}").join(n.videos[v].name)).split("{{SCREEN_URL}}").join(n.videos[v].screen)).split("{{VIDEO_URL}}").join(n.videos[v].video);A=(A=(A=(A=(A=A.split("{{VIDEO_THUMB}}").join("")).split("{{SCREENSHOT}}").join(h("SCREENSHOT"))).split("{{THUMBNAIL}}").join(h("THUMBNAIL"))).split("{{VIDEO}}").join(h("VIDEO"))).split("{{DEVICE_ID}}").join(e),A=f.split("{{FOSCAM_VIDEOS}}").join(A),t=t.split("{{FOSCAM_VIDEO_LIST}}").join(A)}return t=t.split("{{FOSCAM_VIDEO_LIST}}").join(""),"object"==typeof SB&&(c=SB.getByClass("image-list",SB.get(e),"div")[0],l=SB.getByTag("ol",c)[0],u=SB.getByClass("video-list",SB.get(e),"div")[0],p=SB.getByTag("ol",u)[0],t=t.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),a=SB.getByClass("fa-lock",SB.get(e),"a")[0],r=SB.getByClass("fa-unlock",SB.get(e),"a")[0],l&&g!==l.outerHTML&&c.removeChild(l),!n.photos||l&&g===l.outerHTML||(g=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?g.split("{{LAZY_LOAD_IMAGE}}").join("src"):g.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),c.innerHTML=g),p&&A!==p.outerHTML&&u.removeChild(p),!n.videos||p&&A===p.outerHTML||(A=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?A.split("{{LAZY_LOAD_IMAGE}}").join("src"):A.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),u.innerHTML=A),"on"!==n.alarm||SB.hasClass(a,"device-on")?"off"!==n.alarm||SB.hasClass(r,"device-on")||(SB.addClass(r,"device-active"),SB.removeClass(a,"device-active"),SB.putText(SB.getByTag("em",a)[0],m),SB.putText(SB.getByTag("em",r)[0],m),t=""):(SB.addClass(a,"device-active"),SB.removeClass(r,"device-active"),SB.putText(SB.getByTag("em",a)[0],m),SB.putText(SB.getByTag("em",r)[0],m),t="")),t}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.gerty=function(e,t,i,n,s,o){var a,r,l,c,p,u=s.comment,S="",E="",d=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"gerty"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"gerty",o)};if(n.comments)for(r in n.comments)n.comments.hasOwnProperty(r)&&(p=n.comments[r].time,a="object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(p,d):require(__dirname+"/../../lib/sharedUtil").util.displayTime(p,d),E=(E=(E=(E+=u.split("{{TIME}}").join(a)).split("{{CODE}}").join(n.comments[r].code)).split("{{NAME}}").join(n.comments[r].name)).split("{{COMMENT}}").join(n.comments[r].text));return t="object"==typeof SB?(l=SB.getByTag("span",SB.get(e))[0],c=SB.getByTag("ol",SB.get(e))[0],l&&l.innerHTML!==n.emoji&&(SB.putText(l,n.emoji),l.className=n.action||""),c&&c.innerHTML!==E&&(c.innerHTML=E,c.scrollTop=c.scrollHeight),""):(n.action&&(S=' class="'+n.action+'"'),(t=(t=t.split("{{GERTY_ACTION}}").join(S)).split("{{GERTY_DYNAMIC}}").join(n.emoji)).split("{{GERTY_COMMENTS}}").join(E))}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.github=function(e,t,i,n,s,o){var a,r=s.commit,l=s.message,c="",p="",u=0,S=null,E=null,d="",B=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"github"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"github",o)};if(i&&n)for(;u<n.length;u+=1)a=n[u].time,p="object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(a,B,"long"):require(__dirname+"/../../lib/sharedUtil").util.displayTime(a,B,"long"),c=(c=(c+=r.split("{{GITHUB_URL}}").join(n[u].url)).split("{{GITHUB_TITLE}}").join(p)).split("{{GITHUB_DESCRIPTION}}").join(n[u].description),!1===n[u].upToDate?E="NEWER":!0===n[u].upToDate&&(S="LATEST");return t=t.replace("{{GITHUB_DYNAMIC}}",c),E?d=B(E):S&&(d=B(S)),c=l.replace("{{GITHUB_MESSAGE}}",d),t=t.replace("{{GITHUB_MESSAGE}}",c)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.haveibeenpwned=function(e,t,i,n,s,o){var a,r=s.allClear,l=s.pwns,c=s.pwn,p="",u=0;if(i&&n&&n.length){for(;u<n.length;u+=1)p=(p=(p=(p+=c.split("{{HAVEIBEENPWNED_TITLE}}").join(n[u].title)).split("{{HAVEIBEENPWNED_DATETIME}}").join(n[u].date)).split("{{HAVEIBEENPWNED_DATE}}").join(n[u].date)).split("{{HAVEIBEENPWNED_DESCRIPTION}}").join(n[u].description);p=l.split("{{HAVEIBEENPWNED_PWNS}}").join(p)}else p=r.split("{{HAVEIBEENPWNED_ALL_CLEAR}}").join((a="ALL_CLEAR",a="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(a,"haveibeenpwned"):require(__dirname+"/../../lib/sharedUtil").util.translate(a,"haveibeenpwned",o)));return t=t.replace("{{HAVEIBEENPWNED_DYNAMIC}}",p)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.location=function(e,t,i,n,s,o){var a,r=s.item,l="",c=0,p=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"location"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"location",o)};if(i&&n)for(;c<n.length;c+=1)l=(l=(l=(l=(l+=r.split("{{LOCATION_NAME}}").join(n[c].name)).split("{{LOCATION_URL}}").join(n[c].url)).split("{{LOCATION_TIME}}").join((a=n[c].time,"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(a,p):require(__dirname+"/../../lib/sharedUtil").util.displayTime(a,p)))).split("{{LOCATION_ALTITUDE}}").join(n[c].alt)).split("{{LOCATION_SPEED}}").join(Math.ceil(n[c].speed));return t=t.replace("{{LOCATION_DYNAMIC}}",l)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.roku=function(e,t,i,n,s){var o=s.list,a=0,r="";if(n)for(a in n)n.hasOwnProperty(a)&&(r=(r=(r+=o.split("{{APP_ID}}").join(n[a].id)).split("{{APP_IMG}}").join(n[a].cache)).split("{{APP_NAME}}").join(n[a].name));return t.replace("{{ROKU_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.monoPrice3dPrinter=function(e,t,i,n){return n=n||{},t=(t=(t=(t=(t=t.split("{{EXTRUDER_TEMP}}").join(n.extruderTemp)).split("{{EXTRUDER_TARGET}}").join(n.extruderTarget)).split("{{BED_TEMP}}").join(n.bedTemp)).split("{{BED_TARGET}}").join(n.bedTarget)).split("{{PERCENT_COMPLETE}}").join(n.percent)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.nest=function(e,t,i,n,s,o){var a,r,l,c,p=s.thermostat,u=s.protect,S=s.group,E="",d="",B="",f={},T=function(e){return e="object"==typeof SB?SB.util.fToC(e):require(__dirname+"/../../lib/sharedUtil").util.fToC(e)},_=function(e){return"group-"+(e="object"==typeof SB?SB.util.encodeName(e):require(__dirname+"/../../lib/sharedUtil").util.encodeName(e))},C=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"nest"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"nest",o)};if(n){for(a in n.devices)if(n.devices.hasOwnProperty(a))if("thermostat"===(f=n.devices[a]).type){switch("object"==typeof SB&&SB.getByClass(_(f.label),SB.get(e),"li")[0]&&(c=SB.getByClass(_(f.label),SB.get(e),"li")[0],r=SB.getByClass("fa-sun-o",c,"a")[0],l=SB.getByClass("fa-snowflake-o",c,"a")[0],"cool"!==f.state||SB.hasClass(l,"device-active")?"heat"!==f.state||SB.hasClass(r,"device-active")?"off"!==f.state||SB.hasClass(c,"device-off")||(SB.addClass(c,"device-off"),SB.removeClass(l,"device-active"),SB.removeClass(r,"device-active"),SB.putText(SB.getByTag("em",c)[0],C("OFF")),t=""):(SB.addClass(r,"device-active"),SB.removeClass(l,"device-active"),SB.removeClass(c,"device-off"),SB.putText(SB.getByTag("em",c)[0],C("HEAT")),t=""):(SB.addClass(l,"device-active"),SB.removeClass(r,"device-active"),SB.removeClass(c,"device-off"),SB.putText(SB.getByTag("em",c)[0],C("COOL")),t="")),E=(E=(E=(E=(E=(E=(E+=p.split("{{SUB_DEVICE_ID}}").join(_(f.label))).split("{{SUB_DEVICE_NAME}}").join(f.label)).split("{{SUB_DEVICE_MAX}}").join(Math.round(f.celsius?T(90):90))).split("{{SUB_DEVICE_MIN}}").join(Math.round(f.celsius?T(50):50))).split("{{SUB_DEVICE_TEMP}}").join(Math.round(f.temp))).split("{{SUB_DEVICE_TARGET}}").join(Math.round(f.target))).split("{{SUB_DEVICE_HUMIDITY}}").join(Math.round(f.humidity)),f.state){case"cool":E=(E=E.split("{{DEVICE_STATE_COOL}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(C("COOL"));break;case"heat":E=(E=E.split("{{DEVICE_STATE_HEAT}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(C("HEAT"));break;default:E=(E=E.split("{{DEVICE_STATE_OFF}}").join(" device-off")).split("{{SUB_DEVICE_STATUS}}").join(C("OFF"))}!0===f.leaf&&(E=E.split("{{DEVICE_STATE_LEAF}}").join(" device-active")),E=(E=(E=(E=(E=(E=(E=n.presence&&"on"===n.presence?E.split("{{DEVICE_STATE_HOME}}").join(" device-active"):E.split("{{DEVICE_STATE_AWAY}}").join(" device-active")).split("{{DEVICE_STATE_COOL}}").join("")).split("{{DEVICE_STATE_HEAT}}").join("")).split("{{DEVICE_STATE_OFF}}").join("")).split("{{DEVICE_STATE_LEAF}}").join("")).split("{{DEVICE_STATE_HOME}}").join("")).split("{{DEVICE_STATE_AWAY}}").join("")}else"protect"===f.type&&(B="","ok"!==f.smoke&&(B+="smoke "),"ok"!==f.co&&(B+="co "),"ok"!==f.battery&&(B+="batt "),B&&(B+="device-active"),d=(d=(d=(d=(d+=u.split("{{SUB_DEVICE_STATE}}").join(B)).split("{{SUB_DEVICE_NAME}}").join(f.label)).split("{{SUB_DEVICE_SMOKE}}").join(f.smoke)).split("{{SUB_DEVICE_CO}}").join(f.co)).split("{{SUB_DEVICE_BATT}}").join(f.battery));E&&(E=(E=(E=S.replace("{{SUB_DEVICE_LIST}}",E)).replace("{{SUB_DEVICE_CLASS}}"," control-device-status")).replace("{{SUB_DEVICE_NAME}}",C("THERMOSTAT"))),d&&(d=(d=(d=S.replace("{{SUB_DEVICE_LIST}}",d)).replace("{{SUB_DEVICE_CLASS}}"," text-device-status")).replace("{{SUB_DEVICE_NAME}}",C("PROTECT")))}return t=t.replace("{{NEST_DYNAMIC}}",E+d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.powerView=function(e,t,i,n,s,o){var a,r,l,c,p=s.blind,u=s.blinds,S=s.scene,E=s.scenes,d="",B="",f=0,T=0;if(n&&n.devices){for(;f<n.devices.length;f+=1)a=n.devices[f],d=(d=(d=(d=(d+=p.split("{{SUB_DEVICE_ID}}").join((c=a.label,c="object"==typeof SB?SB.util.encodeName(c):require(__dirname+"/../../lib/sharedUtil").util.encodeName(c)))).split("{{SUB_DEVICE_PERCENTAGE}}").join(a.percentage)).split("{{SUB_DEVICE_STATE_CLASS}}").join(a.battery&&a.battery<10?"peripheral batt":"")).split("{{SUB_DEVICE_STATE}}").join(a.battery?" ("+a.battery+"%)":"")).split("{{SUB_DEVICE_NAME}}").join(a.label);if(d=d.split("{{i18n_SET_PERCENTAGE}}").join((l="SET_PERCENTAGE",l="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(l,"powerView"):require(__dirname+"/../../lib/sharedUtil").util.translate(l,"powerView",o))),d=u.split("{{POWERVIEW_BLINDS}}").join(d),n.scenes.length){for(;T<n.scenes.length;T+=1)r=n.scenes[T],B=(B=(B+=S.split("{{SCENE_NAME_COMMAND}}").join(r.name)).split("{{SCENE_NAME}}").join(r.name)).split("{{SCENE_ICON}}").join(r.icon);B=E.split("{{POWERVIEW_SCENES}}").join(B)}}return t=t.split("{{POWERVIEW_DYNAMIC}}").join(d+B)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.raspberryRemote=function(e,t,i,n,s){var o,a,r=s.switch,l=0,c="";if(n&&"object"==typeof n&&(o=n.devices))for(l in o)o.hasOwnProperty(l)&&(c=(c+=(a=o[l],r.split("{{SUB_DEVICE_ID}}").join(a.label.split(" ").join("+")).split("{{SUB_DEVICE_NAME}}").join(a.label))).split("{{SUB_DEVICE_CLASS}}").join(o[l].className||"fa-lightbulb-o"));return t.replace("{{RASPBERRY_REMOTE_DYNAMIC}}",c)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.roku=function(e,t,i,n,s){var o=s.list,a=0,r="";if(n)for(a in n)n.hasOwnProperty(a)&&(r=(r=(r+=o.split("{{APP_ID}}").join(n[a].id)).split("{{APP_IMG}}").join(n[a].cache)).split("{{APP_NAME}}").join(n[a].name));return t.replace("{{ROKU_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.rss=function(e,t,i,n,s){var o=s.item,a="",r=0,l="";if(i&&n)for(;r<n.length;r+=1)l=n[r].description?n[r].description:n[r].text,a=(a=(a+=o.split("{{RSS_URL}}").join(n[r].url)).split("{{RSS_TITLE}}").join(n[r].title)).split("{{RSS_DESCRIPTION}}").join(l);return t=t.replace("{{RSS_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.smartthings=function(e,t,i,n,s,o){var a,r,l,c=s.action,p=s.static,u=s.group,S=0,E=0,d="",B="",f="",T=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"smartthings"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"smartthings",o)},_=function(e,t){var i={},n=[],s=0,o=0;for(s in t)t.hasOwnProperty(s)&&(i=t[s]).label===e&&(n[o]=i,o+=1);return n},C=function(e){var t="",i="",n="",s=[],o="",a="";switch(e.type){case"switch":t=c,n="fa-lightbulb-o";break;case"lock":t=c,n="fa-unlock-alt";break;case"contact":t=p,n="fa-columns";break;case"water":t=p,n="fa-tint";break;case"motion":t=p,n="fa-street-view";break;case"presence":t=p,n="fa-male"}return e.peripheral&&e.peripheral.temp&&s.push(e.peripheral.temp+"&deg;"),e.peripheral&&e.peripheral.battery&&s.push(e.peripheral.battery+"%"),s.length&&(o=" ("+s.join(" ")+")"),e.peripheral&&"on"===e.peripheral.vibrate&&(a=" device-vibrate"),t&&(i=(i=(i=t.split("{{SUB_DEVICE_ID}}").join(e.label.split(" ").join("+"))).split("{{SUB_DEVICE_NAME}}").join(e.label+o)).split("{{SUB_DEVICE_CLASS}}").join(e.className||n),i="on"===e.state?(i=i.split("{{SUB_DEVICE_STATE}}").join(" device-active"+a)).split("{{SUB_DEVICE_STATUS}}").join(T("ACTIVE")):e.peripheral&&e.peripheral.battery&&e.peripheral.battery<10?(i=i.split("{{SUB_DEVICE_STATE}}").join(" peripheral batt"+a)).split("{{SUB_DEVICE_STATUS}}").join(T("INACTIVE")):(i=i.split("{{SUB_DEVICE_STATE}}").join(a)).split("{{SUB_DEVICE_STATUS}}").join(T("INACTIVE"))),i};if(n&&"object"==typeof n&&"string"==typeof n.mode){if(B=n.mode,a=n.devices)if(n.groups){for(S in n.groups)if(n.groups.hasOwnProperty(S)){for(E in d+=u,f="",n.groups[S])n.groups[S].hasOwnProperty(E)&&(r=_(n.groups[S][E],a))&&r[0]&&(f+=C(r[0]));d=(d=(d=d.split("{{GROUP_CLASS}}").join((l=S,"group-"+(l="object"==typeof SB?SB.util.encodeName(l):require(__dirname+"/../../lib/sharedUtil").util.encodeName(l))))).split("{{GROUP_TITLE}}").join(S)).split("{{SUB_DEVICE_LIST}}").join(f)}}else for(S in a)a.hasOwnProperty(S)&&(d+=C(a[S]));switch(B){case"Home":t=(t=t.split("{{DEVICE_STATE_HOME}}").join(" device-active")).split("{{HOME_STATUS}}").join(T("ACTIVE"));break;case"Away":t=(t=t.split("{{DEVICE_STATE_AWAY}}").join(" device-active")).split("{{AWAY_STATUS}}").join(T("ACTIVE"));break;case"Night":t=(t=t.split("{{DEVICE_STATE_NIGHT}}").join(" device-active")).split("{{NIGHT_STATUS}}").join(T("ACTIVE"))}}return(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_STATE_HOME}}").join("")).split("{{DEVICE_STATE_AWAY}}").join("")).split("{{DEVICE_STATE_NIGHT}}").join("")).split("{{HOME_STATUS}}").join(T("INACTIVE"))).split("{{AWAY_STATUS}}").join(T("INACTIVE"))).split("{{NIGHT_STATUS}}").join(T("INACTIVE"))).replace("{{SMARTTHINGS_DYNAMIC}}",d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.sports=function(e,t,i,n,s,o){var a,r=s.image,l=s.league,c=s.game,p=0,u=0,S={},E={},d="",B="",f="",T="",_="",C="",m="",g="",A="",I=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"sports"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"sports",o)};if(i&&n)for(p in n)if(n[p]&&n[p].games.length){for(S=n[p],m="",u=0;u<S.games.length;u+=1)E=S.games[u],d=I("TITLE").split("{{AWAY}}").join(E.away.title).split("{{HOME}}").join(E.home.title),f=E.away.winner?" winner":"",B=E.home.winner?" winner":"",T=E.away.winner?" ("+I("WINNER")+")":"",_=E.home.winner?" ("+I("WINNER")+")":"",A=g="",m=(m=(m=(m=(m=(m=(m=(m=(m=(m=(m=(m=(m+=c.split("{{GAME_LINK}}").join(E.url||"#")).split("{{GAME_TITLE}}").join(d)).split("{{GAME_AWAY_WINNER_CLASS}}").join(f)).split("{{GAME_AWAY_WINNER}}").join(T)).split("{{GAME_AWAY_TEAM}}").join(E.away.title)).split("{{GAME_AWAY_SCORE}}").join(E.away.score)).split("{{GAME_HOME_WINNER_CLASS}}").join(B)).split("{{GAME_HOME_WINNER}}").join(_)).split("{{GAME_HOME_TEAM}}").join(E.home.title)).split("{{GAME_HOME_SCORE}}").join(E.home.score)).split("{{GAME_TIME}}").join((a=E.time,"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(a,I):require(__dirname+"/../../lib/sharedUtil").util.displayTime(a,I)))).split("{{GAME_STATUS}}").join((E.status||"").toLowerCase())).split("{{GAME_STATE}}").join(I(E.status)),E.away.image&&(g=(g=r.split("{{TEAM_IMAGE}}").join(E.away.image)).split("{{TEAM_NAME}}").join(I("AWAY_TEAM_LOGO"))),E.home.image&&(A=(A=r.split("{{TEAM_IMAGE}}").join(E.home.image)).split("{{TEAM_NAME}}").join(I("HOME_TEAM_LOGO"))),m=(m=m.split("{{GAME_AWAY_IMAGE}}").join(g)).split("{{GAME_HOME_IMAGE}}").join(A);C=(C+=l.split("{{LEAGUE_NAME}}").join(S.title)).split("{{GAME_LIST}}").join(m)}return t.replace("{{SPORTS_DYNAMIC}}",C)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.stocks=function(e,t,i,n,s,o){var a=s.list,r=0,l="",c="",p="",u="",S=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"stocks"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"stocks",o)};if(n)for(r in n)n.hasOwnProperty(r)&&(c="neutral",p="arrows-h",u=S("NEUTRAL"),n[r].dayChangeValue&&(0===n[r].dayChangeValue.indexOf("+")?(c="gain",p="arrow-up",u=S("GAIN")):0===n[r].dayChangeValue.indexOf("-")&&(c="loss",p="arrow-down",u=S("LOSS"))),l=(l=(l=(l=(l=(l=(l+=a.split("{{STOCK_CHANGE}}").join(c)).split("{{STOCK_ARROW}}").join(p)).split("{{STOCK_DIRECTION}}").join(u)).split("{{STOCK_NAME}}").join(n[r].name)).split("{{STOCK_PRICE}}").join(n[r].price)).split("{{STOCK_CHANGE_VALUE}}").join(n[r].dayChangeValue)).split("{{STOCK_CHANGE_PERCENT}}").join(n[r].dayChangePercent));return t.replace("{{STOCKS_DYNAMIC}}",l)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.traffic=function(e,t,i,n,s){var o=s.list,a=0,r="";if(n)for(a in n)n.hasOwnProperty(a)&&(r=(r+=o.split("{{CAM_IMG}}").join(n[a].image)).split("{{CAM_NAME}}").join(n[a].title));return t.replace("{{TRAFFIC_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.travis=function(e,t,i,n,s){var o=s.build,a="",r="",l="",c=0;if(i&&n)for(;c<n.length;c+=1)l=r="","created"===n[c].state||"started"===n[c].state?r="cogs":"ok"===n[c].status?r="check":"err"===n[c].status&&(r="times"),n[c].duration&&(l=" ("+n[c].duration+"s)"),a=(a=(a=(a=(a+=o.split("{{TRAVIS_URL}}").join(n[c].url)).split("{{TRAVIS_ICON}}").join(r)).split("{{TRAVIS_STATE}}").join(n[c].status)).split("{{TRAVIS_DURATION}}").join(l)).split("{{TRAVIS_DESCRIPTION}}").join(n[c].label);return t=t.replace("{{TRAVIS_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.twitter=function(e,t,i,n,s){var o=s.tweet,a="",r=0;if(i&&n)for(;r<n.length;r+=1)a=(a=(a+=o.split("{{TWEET_TEXT}}").join(n[r].text)).split("{{TWEET_URL}}").join(n[r].url)).split("{{TWEET_AUTHOR}}").join(n[r].author);return t=t.replace("{{TWITTER_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.weather=function(e,t,i,n,s,o){var a,r,l=s.forecast,c=0,p="";if(a=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"weather"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"weather",o)},r=function(e){var t="warning",i="bolt",n="snowflake-o",s="tint",o="fire",a="cloud",r="sun-o";return{0:t,1:t,2:t,3:i,4:i,5:n,6:n,7:n,8:n,9:s,10:s,11:s,12:s,13:n,14:n,15:n,16:n,17:n,18:n,19:o,20:o,21:o,22:o,23:"flag",24:"flag",25:n,26:a,27:a,28:a,29:a,30:a,31:"moon-o",32:r,33:"moon-o",34:r,35:n,36:r,37:i,38:i,39:i,40:s,41:n,42:n,43:n,44:a,45:i,46:n,47:i}[e=parseInt(e,10)]||"question"},n&&n.code)for(c in t=(t=(t=(t=t.replace("{{WEATHER_ICON}}",r(n.code))).replace("{{WEATHER_CURRENT}}",n.city+" "+a("CURRENT")+": "+n.temp+"&deg; "+n.text)).replace("{{WEATHER_SUNRISE}}",n.sunrise)).replace("{{WEATHER_SUNSET}}",n.sunset),n.forecast)n.forecast.hasOwnProperty(c)&&(p=(p=(p=(p=(p+=l.split("{{WEATHER_ICON}}").join(r(n.forecast[c].code))).split("{{WEATHER_DAY}}").join(n.forecast[c].day+":")).split("{{WEATHER_TEXT}}").join(n.forecast[c].text)).split("{{WEATHER_HIGH}}").join(n.forecast[c].high+"&deg;")).split("{{WEATHER_LOW}}").join(n.forecast[c].low+"&deg;"));else t=(t=(t=t.replace("{{WEATHER_CURRENT}}",a("UNAVAILABLE"))).replace("{{WEATHER_SUNRISE}}","")).replace("{{WEATHER_SUNSET}}",""),"string"==typeof n&&(p=n);return t.replace("{{WEATHER_DYNAMIC}}",p)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.website=function(e,t,i,n){var s="";return n&&n.source&&(s=n.source),t.replace("{{WEBSITE_DYNAMIC}}",s)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.wemo=function(e,t,i,n,s,o){var a,r,l=s.switch,c=s.group,p=0,u=0,S="",E="",d="",B=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"wemo"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"wemo",o)},f=function(e,t){var i={},n=0;for(n in t)if(t[n].label===e){i=t[n];break}return i},T=function(e){var t="";return E&&(E+="device-active"),t=(t=(t=l.split("{{SUB_DEVICE_ID}}").join(e.label.split(" ").join("+"))).split("{{SUB_DEVICE_NAME}}").join(e.label)).split("{{SUB_DEVICE_CLASS}}").join(e.className||"fa-lightbulb-o"),t="on"===e.state?(t=t.split("{{SUB_DEVICE_STATE}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(B("ACTIVE")):"off"===e.state?(t=t.split("{{SUB_DEVICE_STATE}}").join("")).split("{{SUB_DEVICE_STATUS}}").join(B("INACTIVE")):(t=t.split("{{SUB_DEVICE_STATE}}").join(" device-off")).split("{{SUB_DEVICE_STATUS}}").join(B("INACTIVE"))};if(n&&n.devices){if(n.groups){for(p in n.groups)if(n.groups.hasOwnProperty(p)){for(u in S+=c,d="",n.groups[p])n.groups[p].hasOwnProperty(u)&&(a=f(n.groups[p][u],n.devices))&&(d+=T(a));S=(S=(S=S.split("{{GROUP_CLASS}}").join((r=p,r="object"==typeof SB?SB.util.encodeName(r):require(__dirname+"/../../lib/sharedUtil").util.encodeName(r)))).split("{{GROUP_TITLE}}").join(p)).split("{{SUB_DEVICE_LIST}}").join(d)}}else for(p in n.devices)n.devices.hasOwnProperty(p)&&(S+=T(n.devices[p]));S&&(S=S.replace("{{SUB_DEVICE_CLASS}}"," text-device-status"))}return t.replace("{{WEMO_DYNAMIC}}",S)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.xbmc=function(e,t,i,n,s){var o=s.current,a="";return n&&n.current&&(a=o.split("{{DEVICE_CURRENT}}").join(n.current)),t.replace("{{XBMC_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(o){"use strict";o.util={version:20171030,replaceAll:function(e,t,i){var n=e;return"string"==typeof e&&(n=e.replace(new RegExp(t,"g"),i)),n},stripTags:function(e){return"string"==typeof e?e.replace(/(<([^>]+)>)/gi,""):e},stripControl:function(e){return"string"==typeof e?e.replace(new RegExp("[\0-]+","g"),""):e},sanitize:function(e){return o.util.stripTags(o.util.stripControl(e))},encodeName:function(e){return e&&"string"==typeof e&&(e=e.replace(/[\s!@#$%^&*()"'\\<>,;.:/+]/g,"_").toLowerCase()),e},translate:function(e,t,i){return e&&"string"==typeof e?(e=e.toUpperCase(),("object"==typeof SB?(i=document.documentElement.getAttribute("lang"),function(e,t){var i=SB.getByClass(t,SB.getByTag("main")[0],"section")[0];return e=e.replace("{{i18n_","").replace("}}",""),i.dataset&&i.dataset["string"+e.charAt(0)+e.substr(1).toLowerCase()]?e=i.dataset["string"+e.charAt(0)+e.substr(1).toLowerCase()]:SB.spec.strings[e]&&(e=SB.spec.strings[e]),e}):require(__dirname+"/translate").translate)("{{i18n_"+e+"}}",t,i)):e},arrayList:function(e,t,i){for(var n="",s=0;s<e.length;s+=1)s&&(s===e.length-1?n=n+" "+o.util.translate("AND",t,i)+" ":n+=", "),n+=e[s];return n},displayRelativeTime:function(e){var t,i={day:86400,hour:3600,minute:60,second:1},n={day:"00",hour:"00",minute:"00",second:"00"};for(t in i)i[t]<=e&&(n[t]=Math.floor(e/i[t]),n[t]<10&&(n[t]="0"+n[t]),e-=n[t]*i[t]);return n.day+" "+n.hour+":"+n.minute+":"+n.second},displayTime:function(e,t,i,n){var s=n||new Date(e),o=s.getDate(),a=s.getDay(),r=s.getHours(),l=s.getMinutes(),c=t("am"),p="";switch(12<r&&(r-=12,c=t("pm")),r=0===r?12:r,l<10&&(l="0"+l),a=t({0:"sun",1:"mon",2:"tue",3:"wed",4:"thur",5:"fri",6:"sat"}[a]),i){case"long":p=a+" "+o+" @ "+r+":"+l+c;break;default:p=a+" @ "+r+":"+l+c}return p},fToC:function(e){return Math.round((e-32)/1.8*10)/10},cToF:function(e){return Math.round(10*(1.8*e+32))/10}}}("undefined"==typeof exports?this.SB:exports);