/* 20170701 */

SB=function(){"use strict";return{version:20170320,isChildOf:function(e,t){if(t===e)return!1;for(;e&&e!==t&&e!==document.body;)e=e.parentNode;return e===t},event:{list:[],add:function(e,t,n,i){i=i||!1,e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n,SB.event.list.push([e,t,n])},remove:function(e,t,n,i){i=i||!1;var s=0;for(e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null,s;s<SB.event.list.length;s+=1)if(SB.event.list[s]&&SB.event.list[s]&&SB.event.list[s][0]===e&&SB.event.list[s][1]===t&&SB.event.list[s][2]===n){SB.event.list.splice(s,1);break}},removeAll:function(e){e=e||document;var t=SB.event.list.length-1;for(t;t>=0;t-=1)SB.event.list[t]&&(SB.event.list[t][0]!==e&&e!==document||SB.event.remove(SB.event.list[t][0],SB.event.list[t][1],SB.event.list[t][2]))}},getTarget:function(e){return e=e||window.event,e.target?e.target:e.srcElement},hasAttribute:function(e,t,n){if(e[t])return!!e[t].match(new RegExp("(\\s|^)"+n+"(\\s|$)"))},hasClass:function(e,t){var n=!1;return e&&e.className&&(n=!!SB.hasAttribute(e,"className",t)),n},addClass:function(e,t){e&&t&&(SB.hasClass(e,t)||(e.className=SB.trim(e.className+" "+t)))},removeClass:function(e,t){SB.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," "),e.className=SB.trim(e.className))},toggleClass:function(e,t){SB.hasClass(e,t)?SB.removeClass(e,t):SB.addClass(e,t)},setFocus:function(e){"function"==typeof e.setActive?e.setActive():"function"==typeof e.focus&&e.focus()},get:function(e){return document.getElementById(e)},getByTag:function(e,t){return(t=t||document).getElementsByTagName(e)},getByClass:function(e,t,n){var i=[],s=[],o=0,r=0;if(t=t||document,"*"===(n=n.toLowerCase()||"*")&&document.getElementsByClassName)return t.getElementsByClassName(e);if(t.getElementsByClassName)if(s=t.getElementsByClassName(e),n&&s.length)for(o in s)s[o].tagName&&s[o].tagName.toLowerCase()===n&&(i[r]=s[o],r+=1);else i=s;else{s=SB.getByTag(n,t);for(o in s)SB.hasClass(s[o],e)&&(i[r]=s[o],r+=1)}return i},getText:function(e){return e.textContent?e.textContent:e.innerText?e.innerText:e.text?e.text:e.innerHTML},putText:function(e,t){e.textContent?e.textContent=t:e.innerText?e.innerText=t:e.text?e.text=t:e.innerHTML=t},stripUnits:function(e){return"string"==typeof e?parseInt(e.replace(new RegExp("(%|px|em)"),""),10):e},trim:function(e){return(e=e||"").toString().replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replaceAll:function(e,t,n){var i=e;return"string"==typeof e&&(i=e.replace(new RegExp(t,"g"),n)),i},decode:function(e){var t="";return"object"==typeof JSON&&(t=JSON.parse(e)),t},encode:function(e){var t="";return"object"==typeof JSON&&(t=JSON.stringify(e)),t},log:function(e,t,n){var i=new Date,s="color: white";if("object"==typeof console&&"function"==typeof console.log)if(t&&"object"!=typeof e){switch(e="%c"+t+"%c: "+e+" ("+i.getHours()+":"+(i.getMinutes()<10?"0":"")+i.getMinutes()+")",n){case"success":s="color: green";break;case"info":s="color: aqua";break;case"error":s="color: red"}console.log(e,"background: black; "+s,"background: black; color: white")}else console.log(e)},vibrate:function(e){e=e||20,window.navigator&&window.navigator.vibrate?window.navigator.vibrate(e):SB.log("Not supported","Vibrate","error")},notify:function(e,t,n){var i,s;return"function"==typeof Notification&&("granted"===Notification.permission?(i=new Notification(e,t),setTimeout(function(){i.close(),SB.event.remove(i,"click",s)},1e4),s=function(e){window.focus(),n(e),SB.event.remove(i,"click",s)},SB.event.add(i,"click",s)):SB.notifyAsk()),i},notifyAsk:function(){"function"==typeof Notification&&"denied"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)})},sound:{sounds:{},play:function(e){"function"==typeof Audio&&(SB.sound.sounds[e]||(SB.sound.sounds[e]=new Audio(e)),SB.sound.sounds[e].play())}},speak:function(e,t,n){var i,s;window.speechSynthesis?(i=new SpeechSynthesisUtterance,s=window.speechSynthesis.getVoices(),i.text=e,i.lang=t||"en-US",s&&s[10]&&"Alex"===s[10].name&&(i.voice=s[10],"female"===n&&(i.voice=s[30])),window.speechSynthesis.speak(i)):SB.log("Not supported","Speak","error")},transcribe:function(e){var t,n;return"webkitSpeechRecognition"in window?(SB.log("Supported","Transcribe","info"),t=new webkitSpeechRecognition,n=function(t){e(t.results[0][0].transcript,t.results[0][0].confidence),SB.event.remove(document,"result",n)},SB.event.add(t,"result",n)):SB.log("Not supported","Transcribe","error"),t},storage:function(e,t){var n;return e&&("undefined"!=typeof localStorage?(void 0!==t&&("object"==typeof t&&(t=SB.encode(t)),localStorage.setItem(e,t)),n=localStorage.getItem(e)):SB.log("Not supported","Local Storage","error")),n},ajax:{request:function(e){e.method=e.method||"GET",e.onStart=e.onStart||function(){},e.onComplete=e.onComplete||function(){};var t,n,i="?";if(n=function(){switch(e.onStart(),typeof e.onComplete){case"object":e.onComplete.value?e.onComplete.value=e.response:e.onComplete.childNodes[0]&&SB.putText(e.onComplete,e.response);break;case"function":e.onComplete()}},window.XMLHttpRequest)t=new XMLHttpRequest;else{if(!window.ActiveXObject)return!1;t=new ActiveXObject("Microsoft.XMLHTTP")}"GET"===e.method&&(-1===e.path.indexOf("?")&&-1===e.param.indexOf("?")||(i="&"),e.path=e.path+i+e.param,e.param=""),t.open(e.method.toUpperCase(),e.path,!0),"POST"===e.method&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("rest","true"),SB.event.add(t,"readystatechange",function(){if(4===t.readyState){if(200!==t.status)return!1;e.response=t.responseText,n()}}),t.send(e.param)}},init:function(){SB.spec&&SB.spec.init&&SB.spec.init(),SB.addClass(document.body,"rich")}}}(),document.addEventListener&&document.addEventListener("DOMContentLoaded",SB.init,!1),SB.event.add(window,"load",function(){"use strict";document.addEventListener||SB.init()}),SB.event.add(window,"unload",function(){"use strict";SB.event.removeAll()}),"object"==typeof module&&(module.exports=SB),SB.spec=function(){"use strict";return{version:20170414,state:{},parsers:{},templates:{},strings:{},socket:{},uiComponents:{header:{},body:{},indicator:{},templates:[]},ariaDevice:function(){var e=SB.getByClass("selected",SB.spec.uiComponents.header,"li")[0],t=SB.getByTag("h2",SB.spec.uiComponents.header)[0],n=SB.spec.strings.CURRENT.split("{{DEVICE}}").join(SB.getText(e));SB.putText(t,n),n=null},navChange:function(e){var t=SB.getByClass(e,SB.spec.uiComponents.header,"li")[0],n=SB.get(e),i=SB.getByClass("selected",SB.spec.uiComponents.header,"li")[0],s=SB.getByClass("selected",SB.spec.uiComponents.body,"section")[0];t&&!SB.hasClass(t,"selected")&&(SB.removeClass(i,"selected"),SB.removeClass(s,"selected"),SB.spec.lazyLoad(e),SB.storage("selected",e),SB.addClass(t,"selected"),SB.addClass(n,"selected"),SB.spec.lazyUnLoad(s),SB.spec.ariaDevice())},updateTemplate:function(e){var t,n,i,s,o,r=SB.get(e.deviceId),a=SB.spec.parsers[e.typeClass],c=e.value,l=e.state,p=document.createElement("div"),u=!1;return SB.spec.state[e.deviceId]=e,SB.log("Updated",e.deviceId,"success"),r&&(i=SB.spec.uiComponents.templates[e.typeClass].markup,n=SB.hasClass(r,"selected")?" selected":"",s=r.cloneNode(!0),(t=SB.getByTag("h1",s)[0]).parentNode.removeChild(t),o=s.innerHTML,a&&(i=a(e.deviceId,i,l,c,SB.spec.uiComponents.templates[e.typeClass].fragments)),"ok"===l?(i=i.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.ACTIVE),SB.hasClass(r,"device-off")&&(SB.removeClass(r,"device-off"),SB.addClass(r,"device-on"),SB.putText(SB.getByTag("em",SB.getByTag("h1",r)[0])[0],SB.spec.strings.ACTIVE))):(i=i.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.INACTIVE),SB.hasClass(r,"device-on")&&(SB.removeClass(r,"device-on"),SB.addClass(r,"device-off"),SB.putText(SB.getByTag("em",SB.getByTag("h1",r)[0])[0],SB.spec.strings.INACTIVE))),r&&i&&e&&(SB.storage("state",SB.spec.state),i=(i=(i=i.split("{{DEVICE_ID}}").join(e.deviceId)).split("{{DEVICE_TYPE}}").join(e.typeClass)).split("{{DEVICE_SELECTED}}").join(n),i="ok"===e.state?i.split("{{DEVICE_STATE}}").join(" device-on"):i.split("{{DEVICE_STATE}}").join(" device-off"),i=n?i.split("{{LAZY_LOAD_IMAGE}}").join("src"):i.split("{{LAZY_LOAD_IMAGE}}").join("data-src")),i&&(p.innerHTML=i,p=SB.getByTag("section",p)[0],(t=SB.getByTag("h1",p)[0]).parentNode.removeChild(t),p.innerHTML!==o&&(r.outerHTML=i,u=!0))),r=null,a=null,c=null,l=null,t=null,n=null,i=null,p=null,s=null,o=null,u},buildIndicator:function(){var e;SB.get("indicator")||((e=document.createElement("span")).id="indicator",SB.addClass(e,"connecting"),SB.putText(e,SB.spec.strings.CONNECTING),SB.spec.uiComponents.indicator=e,SB.spec.uiComponents.header.appendChild(e))},checkConnection:function(){var e=SB.spec.socket.readyState<=1;return e||(SB.spec.socketConnect(0),e=SB.spec.socket.readyState<=1),e},socketConnect:function(e){var t,n,i,s,o,r="https:"===window.location.protocol?"wss":"ws";SB.spec.socket.readyState&&3!==SB.spec.socket.readyState||(SB.log("Connecting","WebSocket","info"),SB.spec.socket=new WebSocket(r+"://"+window.location.host,"echo-protocol"),e+=1,t=function(){var t=Math.round(Math.min(Math.max(e*(15*Math.random()),10),60));SB.log("Retrying in "+t+"s","WebSocket","info"),SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED),setTimeout(function(){SB.spec.socketConnect(e)},1e3*t)}),n=function(){var e="disconnected"===SB.spec.uiComponents.indicator.className;SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),SB.log("Connected","WebSocket","success"),e&&(SB.spec.socket.send("fetch state"),SB.log("Reconnected","WebSocket","success"))},i=function(e){var t,n=SB.decode(e.data),i={};if("string"==typeof n.speech)n.speech&&(SB.log(n.speech,"Speech","success"),SB.speak(n.speech,n.language,n.voice));else if("string"==typeof n.sound)SB.log(n.sound,"Sound","success"),SB.sound.play("/mp3/"+n.sound+".mp3");else if("string"==typeof n.vibrate)SB.log(n.vibrate,"Vibrate","success"),SB.vibrate(100*n.vibrate);else if("string"==typeof n.title)t=function(){n.deviceId&&SB.spec.navChange(n.deviceId)},SB.notify(n.title,n.options,t);else if("string"==typeof n.deviceId)SB.spec.updateTemplate(n);else if("object"==typeof n){for(i in n)if(n.hasOwnProperty(i))break;if(n[i]&&n[i].deviceId){SB.log("Received","State","success");for(i in n)n.hasOwnProperty(i)&&SB.spec.updateTemplate(n[i])}else n[i]&&n[i].markup&&(SB.spec.uiComponents.templates=n,SB.storage("templates",SB.spec.uiComponents.templates))}},s=function(){SB.event.remove(SB.spec.socket,"close",s),SB.log("Disconnected","WebSocket","error"),t()},o=function(){SB.event.remove(SB.spec.socket,"open",n),SB.event.remove(SB.spec.socket,"message",i),SB.event.remove(SB.spec.socket,"close",s),SB.event.remove(SB.spec.socket,"error",o)},SB.event.add(SB.spec.socket,"open",n),SB.event.add(SB.spec.socket,"message",i),SB.event.add(SB.spec.socket,"close",s),SB.event.add(SB.spec.socket,"error",o)},statePoller:function(){var e;SB.log("not supported - using polling","WebSockets","error"),e={path:"/templates/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){SB.spec.uiComponents.templates=SB.decode(e.response),SB.storage("templates",SB.spec.uiComponents.templates)}},SB.ajax.request(e),setInterval(function(){var e={path:"/state/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){var t,n=SB.decode(e.response);if(n){SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),setTimeout(function(){SB.spec.uiComponents.indicator.className="connecting",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTIG)},1e3);for(t in n)n.hasOwnProperty(t)&&SB.spec.updateTemplate(n[t])}else SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED)}};SB.ajax.request(e)},1e4)},lazyLoad:function(e){var t,n,i,s,o=0;if(SB.get(e))for(t=SB.get(e),n=Array.prototype.slice.call(SB.getByTag("img",t)),i=Array.prototype.slice.call(SB.getByTag("iframe",t)),s=n.concat(i),o;o<s.length;o+=1)s[o].getAttribute("data-src")&&!s[o].src&&(s[o].src=s[o].getAttribute("data-src"))},lazyUnLoad:function(e){var t,n,i,s=0;if(e)for(t=Array.prototype.slice.call(SB.getByTag("img",e)),n=Array.prototype.slice.call(SB.getByTag("iframe",e)),i=t.concat(n),s=0;s<i.length;s+=1)i[s].getAttribute("src")&&(SB.hasClass(i[s],"streaming")||"IFRAME"===i[s].tagName)&&(i[s].setAttribute("data-src",i[s].src),i[s].removeAttribute("src"))},openModal:function(e){var t,n,i,s,o,r=e.getAttribute("data-modal-container"),a=SB.get(r),c=e.getAttribute("title"),l=e.href,p=l.split(".").pop(),u=SB.getByClass("close-modal",a,"a")||[];switch(u.length&&this.closeModal(u[0]),p.toLowerCase()){case"jpg":case"jpeg":case"gif":case"png":(t=document.createElement("img")).src=l,t.alt=c;break;case"mkv":case"mp4":case"ogg":(t=document.createElement("video")).src=l,t.title=c,t.setAttribute("controls",""),t.setAttribute("autoplay",""),t.setAttribute("type","video/mp4");break;case"mp3":(t=document.createElement("video")).src=l,t.title=c,t.setAttribute("controls",""),t.setAttribute("autoplay",""),t.setAttribute("type","audio/mp3")}t&&((n=document.createElement("div")).className="curtain",n.setAttribute("data-modal-container",r),(i=document.createElement("div")).className="modal",(s=document.createElement("a")).className="close-modal fa fa-close device-active",s.href="#",s.title=SB.spec.strings.CLOSE,s.setAttribute("data-modal-container",r),o=document.createElement("span"),SB.putText(o,SB.spec.strings.CLOSE),s.appendChild(o),i.appendChild(s),i.appendChild(t),n.appendChild(i),a.appendChild(n),setTimeout(function(){s.focus()},10))},closeModal:function(e){var t=SB.get(e.getAttribute("data-modal-container"));t.removeChild(SB.getByClass("curtain",t,"div")[0])},command:function(e){var t=null,n=0,i=750,s=!1,o=!1,r=!1,a=!0,c=0,l=0,p=null,u=function(){t=null,i=750,n=0,r=!0,o=!1,a=!0,c=0,l=0},S=function(n){var i=t;SB.vibrate(),e||SB.spec.sendTextInput(n,i,"text"),u()},d=function(e){var t=SB.getTarget(e),n=t.tagName.toLowerCase(),i=null;return t="img"===n?t.parentNode:t,t="i"===n?t.parentNode:t,t="span"===n?t.parentNode:t,"a"===t.tagName.toLowerCase()?i=t:"curtain"===t.className&&(i=t),i},E=function(){var s;t&&!r&&(SB.vibrate(),e?SB.log("Issued","Demo Command","success"):SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Command","success"),SB.spec.socket.send(t)):(s={path:t,param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){SB.log(s.response)}},SB.ajax.request(s)),n>3&&(i=650),n>10&&(i=500),n+=1,setTimeout(E,i))},B=function(e,n){var i,s=d(e);n?(SB.vibrate(),t=SB.getTarget(e).parentNode.parentNode.id,(p=SB.transcribe(S)).start()):s&&!r&&("external"===s.rel?((i=window.open()).opener=null,i.location=s.href):SB.hasClass(s,"modal")?SB.spec.openModal(s):SB.hasClass(s,"close-modal")||SB.hasClass(s,"curtain")?SB.spec.closeModal(s):(t=s.href,E()))};"ontouchstart"in document.documentElement&&(SB.log("Enabled","Touch Events","info"),SB.event.add(SB.spec.uiComponents.body,"touchstart",function(e){s=!0,o=!0,a=!1,d(e)&&(r=!1,c=parseInt(e.changedTouches[0].clientX,10),l=parseInt(e.changedTouches[0].clientY,10),setTimeout(function(){a||(s=!1,B(e))},450))}),SB.event.add(SB.spec.uiComponents.body,"contextmenu",function(e){e.preventDefault()}),SB.event.add(SB.spec.uiComponents.body,"touchend",function(e){!SB.hasClass(SB.getTarget(e).parentNode,"emoji")&&s&&(a=!0,B(e)),u()}),SB.event.add(SB.spec.uiComponents.body,"touchmove",function(e){o&&(Math.abs(parseInt(e.changedTouches[0].clientX,10)-c)>5||Math.abs(parseInt(e.changedTouches[0].clientY,10)-l)>5)&&u()}),SB.event.add(SB.spec.uiComponents.body,"touchcancel",function(e){u()})),SB.event.add(SB.spec.uiComponents.body,"mousedown",function(e){SB.hasClass(SB.getTarget(e).parentNode,"emoji")?B(e,!0):!1===o&&!1===s&&(r=!1,B(e)),s=!1}),SB.event.add(SB.spec.uiComponents.body,"mouseup",function(e){SB.hasClass(SB.getTarget(e).parentNode,"emoji")||u()}),SB.event.add(SB.spec.uiComponents.body,"click",function(e){d(e)&&e.preventDefault()}),SB.event.add(SB.spec.uiComponents.body,"keyup",function(e){13===e.keyCode&&d(e)&&(r=!1,B(e),setTimeout(function(){r=!0},i/2))})},sendInput:function(e){var t=SB.getByTag("input",e,"input")[0],n=t.value,i=t.name,s=SB.getByClass("input-type",e,"input")[0].value;"text"===t.type&&(t.value=""),SB.spec.sendTextInput(n,i,s)},sendTextInput:function(e,t,n){var i;n=n||"text",SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Text Command","success"),SB.spec.socket.send("/?"+t+"="+n+"-"+e)):(i={path:"/",param:t+"="+n+"-"+e+"&ts="+(new Date).getTime(),method:"POST",onComplete:function(){SB.log(i.response)}},SB.ajax.request(i))},formInput:function(e){SB.event.add(SB.spec.uiComponents.body,"submit",function(t){var n=SB.getTarget(t);t.preventDefault(),e?SB.log("Issued","Demo Text Command","success"):SB.spec.sendInput(n)}),SB.event.add(SB.spec.uiComponents.body,"change",function(t){var n,i,s=SB.getTarget(t),o=s.type;("range"===o||"number"===o&&void 0!==s.max&&void 0!==s.min)&&("range"===o?"number"===(i=s.previousElementSibling).type&&(i.value=s.value):"number"===o&&"range"===(n=s.nextElementSibling).type&&(n.value=s.value),e?SB.log("Issued","Demo Form Command","success"):SB.spec.sendInput(s.form))})},nav:function(){SB.event.add(SB.spec.uiComponents.header,"click",function(e){var t=SB.getTarget(e).parentNode;"li"===t.tagName.toLowerCase()?(e.preventDefault(),SB.spec.navChange(t.className),SB.vibrate(),SB.notifyAsk()):"indicator"===SB.getTarget(e).id&&SB.hasClass(SB.getTarget(e),"disconnected")&&SB.spec.socketConnect(0)})},init:function(){var e,t,n,i=SB.storage("selected"),s=SB.storage("templates"),o=SB.storage("state");if(SB.spec.uiComponents.header=SB.getByTag("header")[0],SB.spec.uiComponents.body=SB.getByTag("main")[0],SB.spec.buildIndicator(),t=SB.spec.uiComponents.header.dataset,n=SB.spec.uiComponents.body.dataset,SB.spec.strings={CURRENT:t.stringCurrent,CONNECTED:t.stringConnected,CONNECTING:t.stringConnecting,DISCONNECTED:t.stringDisconnected,ACTIVE:n.stringActive,INACTIVE:n.stringInactive,ON:n.stringOn,OFF:n.stringOff,CLOSE:n.stringClose,AM:n.stringAm,PM:n.stringPm,SUN:n.stringSun,MON:n.stringMon,TUE:n.stringTue,WED:n.stringWed,THUR:n.stringThur,FRI:n.stringFri,SAT:n.stringSat},i&&SB.spec.navChange(i),s&&o){SB.spec.uiComponents.templates=SB.decode(s),o=SB.decode(o);for(e in o)o.hasOwnProperty(e)&&SB.spec.updateTemplate(o[e])}"function"==typeof WebSocket||"object"==typeof WebSocket?SB.spec.socketConnect(0):SB.spec.statePoller(),SB.spec.lazyLoad(i||document.body.className),SB.spec.command(!1),SB.spec.formInput(!1),SB.spec.nav(),SB.spec.ariaDevice()}}}(),function(e){"use strict";e.activeBuilding=function(e,t,n,i,s){var o="",r="",a="",c="",l=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"activeBuilding"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"activeBuilding",s)};return n&&i&&(c=function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.arrayList(e,"activeBuilding",s):require(__dirname+"/../../lib/sharedUtil").util.arrayList(e,"activeBuilding",s)}(i)),i&&0!==i.length?1===i.length?(r="ok",a="tag",o=l("SINGLE_PACKAGE")):i.length>1&&(r="ok",a="tags",o=l("PLURAL_PACKAGES")):(r="err",a="times",o=l("NO_PACKAGES")),o=o.split("{{SENDERS}}").join(c),t=t.replace("{{ACTIVEBUILDING_STATE}}",r),t=t.replace("{{ACTIVEBUILDING_ICON}}",a),t=t.replace("{{ACTIVEBUILDING_DYNAMIC}}",o)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.debug=function(e,t,n,i,s,o){var r=(new Date).getTime(),a="",c="",l=0,p=0,u=0,S=0,d=0,E=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"debug"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"debug",o)},B=function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayRelativeTime(e):require(__dirname+"/../../lib/sharedUtil").util.displayRelativeTime(e)},f=E("NA");return i&&(a=B(i.uptime),c=B((r-i.startup)/1e3),l=i.memoryUsed,p=i.totalMemory,u=i.percentMemory,S=Math.round(100*i.cpuLoad[0]),d=i.clientCount,f=i.temperature?i.temperature:f),t=t.replace("{{DEBUG_UPDATE}}",function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(e,E):require(__dirname+"/../../lib/sharedUtil").util.displayTime(e,E)}(r)),t=t.replace("{{DEBUG_UPTIME}}",a),t=t.replace("{{DEBUG_RUNTIME}}",c),t=t.replace("{{DEBUG_MEMORY_USED}}",l),t=t.replace("{{DEBUG_SYSTEM_MEMORY}}",p),t=t.replace("{{DEBUG_MEMORY_PERCENT}}",u),t=t.replace("{{DEBUG_CPU}}",S),t=t.replace("{{DEBUG_CLIENT_TEMP}}",f),t=t.replace("{{DEBUG_CLIENT_COUNT}}",d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.denon=function(e,t,n,i){return i&&(t=t.split("{{DEVICE_POWER}}").join(i.power),i.ZONE1&&(t=(t=(t=(t=(t=(t=t.split("{{DEVICE_Z1_INPUT}}").join(i.ZONE1.input)).split("{{DEVICE_Z1_POWER}}").join(i.ZONE1.power)).split("{{DEVICE_Z1_MUTE}}").join(i.ZONE1.mute)).split("{{DEVICE_Z1_MODE}}").join(i.ZONE1.mode)).split("{{DEVICE_Z1_VOLUME}}").join(i.ZONE1.volume)).split("{{DEVICE_Z1_MAXVOLUME}}").join(i.ZONE1.maxvolume)),i.ZONE2&&(t=(t=(t=t.split("{{DEVICE_Z2_POWER}}").join(i.ZONE2.power)).split("{{DEVICE_Z2_INPUT}}").join(i.ZONE2.input)).split("{{DEVICE_Z2_VOLUME}}").join(i.ZONE2.volume)),i.ZONE3&&(t=(t=(t=t.split("{{DEVICE_Z3_POWER}}").join(i.ZONE3.power)).split("{{DEVICE_Z3_INPUT}}").join(i.ZONE3.input)).split("{{DEVICE_Z3_VOLUME}}").join(i.ZONE3.volume))),t=t.split("{{DEVICE_POWER}}").join(""),t=t.split("{{DEVICE_Z1_POWER}}").join(""),t=t.split("{{DEVICE_Z1_INPUT}}").join(""),t=t.split("{{DEVICE_Z1_MUTE}}").join(""),t=t.split("{{DEVICE_Z1_MODE}}").join(""),t=t.split("{{DEVICE_Z1_VOLUME}}").join(""),t=t.split("{{DEVICE_Z1_MAXVOLUME}}").join(""),t=t.split("{{DEVICE_Z2_POWER}}").join(""),t=t.split("{{DEVICE_Z2_INPUT}}").join(""),t=t.split("{{DEVICE_Z2_VOLUME}}").join(""),t=t.split("{{DEVICE_Z3_POWER}}").join(""),t=t.split("{{DEVICE_Z3_INPUT}}").join(""),t=t.split("{{DEVICE_Z3_VOLUME}}").join("")}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.foscam=function(e,t,n,i,s,o){var r,a,c,l,p,u,S,d=s.photo,E=s.photos,B=s.video,f=s.videos,m=s.thumb,T="",C="",_="",g="",v="",I=0,A=0,h=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"foscam"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"foscam",o)};if(i=i||{},"on"===i.alarm?(T=" device-active",_=h("CAMERA_ARMED")):"off"===i.alarm&&(C=" device-active",_=h("CAMERA_DISARMED")),t=t.split("{{DEVICE_STATE_ON}}").join(T),t=t.split("{{DEVICE_STATE_OFF}}").join(C),t=t.split("{{ARMED_STATUS}}").join(_),t=t.split("{{DISARMED_STATUS}}").join(_),t=t.split("{{SCREENSHOT}}").join(h("SCREENSHOT")),t=t.split("{{THUMBNAIL}}").join(h("THUMBNAIL")),t=t.split("{{VIDEO}}").join(h("VIDEO")),i.photos&&i.photos.length){for(I;I<i.photos.length;I+=1)g=(g+=d.split("{{PHOTO_NAME}}").join(i.photos[I].name)).split("{{PHOTO_URL}}").join(i.photos[I].photo);g=(g=g.split("{{PHOTO}}").join(h("PHOTO"))).split("{{DEVICE_ID}}").join(e),g=E.split("{{FOSCAM_PHOTOS}}").join(g),t=t.split("{{FOSCAM_PHOTO_LIST}}").join(g)}if(t=t.split("{{FOSCAM_PHOTO_LIST}}").join(""),i.videos&&i.videos.length){for(A;A<i.videos.length;A+=1)(S=i.videos[A].thumb||"")&&(v=(v=v.split("{{VIDEO_THUMB}}").join(m)).split("{{THUMB_URL}}").join(S)),v=(v=(v+=B.split("{{VIDEO_NAME}}").join(i.videos[A].name)).split("{{SCREEN_URL}}").join(i.videos[A].screen)).split("{{VIDEO_URL}}").join(i.videos[A].video);v=(v=(v=(v=(v=v.split("{{VIDEO_THUMB}}").join("")).split("{{SCREENSHOT}}").join(h("SCREENSHOT"))).split("{{THUMBNAIL}}").join(h("THUMBNAIL"))).split("{{VIDEO}}").join(h("VIDEO"))).split("{{DEVICE_ID}}").join(e),v=f.split("{{FOSCAM_VIDEOS}}").join(v),t=t.split("{{FOSCAM_VIDEO_LIST}}").join(v)}return t=t.split("{{FOSCAM_VIDEO_LIST}}").join(""),"object"==typeof SB&&(l=SB.getByClass("image-list",SB.get(e),"div")[0],c=SB.getByTag("ol",l)[0],u=SB.getByClass("video-list",SB.get(e),"div")[0],p=SB.getByTag("ol",u)[0],t=t.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),r=SB.getByClass("fa-lock",SB.get(e),"a")[0],a=SB.getByClass("fa-unlock",SB.get(e),"a")[0],c&&g!==c.outerHTML&&l.removeChild(c),!i.photos||c&&g===c.outerHTML||(g=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?g.split("{{LAZY_LOAD_IMAGE}}").join("src"):g.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),l.innerHTML=g),p&&v!==p.outerHTML&&u.removeChild(p),!i.videos||p&&v===p.outerHTML||(v=SB.hasClass(SB.getByClass("selected",null,"li")[0],e)?v.split("{{LAZY_LOAD_IMAGE}}").join("src"):v.split("{{LAZY_LOAD_IMAGE}}").join("data-src"),u.innerHTML=v),"on"!==i.alarm||SB.hasClass(r,"device-on")?"off"!==i.alarm||SB.hasClass(a,"device-on")||(SB.addClass(a,"device-active"),SB.removeClass(r,"device-active"),SB.putText(SB.getByTag("em",r)[0],_),SB.putText(SB.getByTag("em",a)[0],_),t=""):(SB.addClass(r,"device-active"),SB.removeClass(a,"device-active"),SB.putText(SB.getByTag("em",r)[0],_),SB.putText(SB.getByTag("em",a)[0],_),t="")),t}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.gerty=function(e,t,n,i,s,o){var r,a,c,l,p=s.comment,u="",S="",d=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"gerty"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"gerty",o)};if(i.comments)for(a in i.comments)i.comments.hasOwnProperty(a)&&(r=function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(e,d):require(__dirname+"/../../lib/sharedUtil").util.displayTime(e,d)}(i.comments[a].time),S=(S=(S=(S+=p.split("{{TIME}}").join(r)).split("{{CODE}}").join(i.comments[a].code)).split("{{NAME}}").join(i.comments[a].name)).split("{{COMMENT}}").join(i.comments[a].text));return"object"==typeof SB?(c=SB.getByTag("span",SB.get(e))[0],l=SB.getByTag("ol",SB.get(e))[0],c&&c.innerHTML!==i.emoji&&(SB.putText(c,i.emoji),c.className=i.action||""),l&&l.innerHTML!==S&&(l.innerHTML=S,l.scrollTop=l.scrollHeight),t=""):(i.action&&(u=' class="'+i.action+'"'),t=(t=(t=t.split("{{GERTY_ACTION}}").join(u)).split("{{GERTY_DYNAMIC}}").join(i.emoji)).split("{{GERTY_COMMENTS}}").join(S)),t}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.github=function(e,t,n,i,s,o){var r=s.commit,a=s.message,c="",l="",p=0,u=null,S=null,d="",E=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"github"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"github",o)};if(n&&i)for(p;p<i.length;p+=1)l=function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(e,E,"long"):require(__dirname+"/../../lib/sharedUtil").util.displayTime(e,E,"long")}(i[p].time),c=(c=(c+=r.split("{{GITHUB_URL}}").join(i[p].url)).split("{{GITHUB_TITLE}}").join(l)).split("{{GITHUB_DESCRIPTION}}").join(i[p].description),!1===i[p].upToDate?S="NEWER":!0===i[p].upToDate&&(u="LATEST");return t=t.replace("{{GITHUB_DYNAMIC}}",c),S?d=E(S):u&&(d=E(u)),c=a.replace("{{GITHUB_MESSAGE}}",d),t=t.replace("{{GITHUB_MESSAGE}}",c)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.haveibeenpwned=function(e,t,n,i,s,o){var r=s.allClear,a=s.pwns,c=s.pwn,l="",p=0;if(n&&i&&i.length){for(p;p<i.length;p+=1)l=(l=(l=(l+=c.split("{{HAVEIBEENPWNED_TITLE}}").join(i[p].title)).split("{{HAVEIBEENPWNED_DATETIME}}").join(i[p].date)).split("{{HAVEIBEENPWNED_DATE}}").join(i[p].date)).split("{{HAVEIBEENPWNED_DESCRIPTION}}").join(i[p].description);l=a.split("{{HAVEIBEENPWNED_PWNS}}").join(l)}else l=r.split("{{HAVEIBEENPWNED_ALL_CLEAR}}").join(function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"haveibeenpwned"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"haveibeenpwned",o)}("ALL_CLEAR"));return t=t.replace("{{HAVEIBEENPWNED_DYNAMIC}}",l)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.location=function(e,t,n,i,s,o){var r=s.item,a="",c=0,l=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"location"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"location",o)};if(n&&i)for(c;c<i.length;c+=1)a=(a=(a=(a=(a+=r.split("{{LOCATION_NAME}}").join(i[c].name)).split("{{LOCATION_URL}}").join(i[c].url)).split("{{LOCATION_TIME}}").join(function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(e,l):require(__dirname+"/../../lib/sharedUtil").util.displayTime(e,l)}(i[c].time))).split("{{LOCATION_ALTITUDE}}").join(i[c].alt)).split("{{LOCATION_SPEED}}").join(Math.ceil(i[c].speed));return t=t.replace("{{LOCATION_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.monoPrice3dPrinter=function(e,t,n,i){return i=i||{},t=t.split("{{EXTRUDER_TEMP}}").join(i.extruderTemp),t=t.split("{{EXTRUDER_TARGET}}").join(i.extruderTarget),t=t.split("{{BED_TEMP}}").join(i.bedTemp),t=t.split("{{BED_TARGET}}").join(i.bedTarget),t=t.split("{{PERCENT_COMPLETE}}").join(i.percent)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.nest=function(e,t,n,i,s,o){var r,a,c,l,p=s.thermostat,u=s.protect,S=s.group,d="",E="",B="",f={},m=function(e){return"group-"+(e="object"==typeof SB?SB.util.encodeName(e):require(__dirname+"/../../lib/sharedUtil").util.encodeName(e))},T=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"nest"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"nest",o)};if(i){for(r in i.devices)if(i.devices.hasOwnProperty(r))if("thermostat"===(f=i.devices[r]).type){switch("object"==typeof SB&&SB.getByClass(m(f.label),SB.get(e),"li")[0]&&(l=SB.getByClass(m(f.label),SB.get(e),"li")[0],a=SB.getByClass("fa-sun-o",l,"a")[0],c=SB.getByClass("fa-snowflake-o",l,"a")[0],"cool"!==f.state||SB.hasClass(c,"device-active")?"heat"!==f.state||SB.hasClass(a,"device-active")?"off"!==f.state||SB.hasClass(l,"device-off")||(SB.addClass(l,"device-off"),SB.removeClass(c,"device-active"),SB.removeClass(a,"device-active"),SB.putText(SB.getByTag("em",l)[0],T("OFF")),t=""):(SB.addClass(a,"device-active"),SB.removeClass(c,"device-active"),SB.removeClass(l,"device-off"),SB.putText(SB.getByTag("em",l)[0],T("HEAT")),t=""):(SB.addClass(c,"device-active"),SB.removeClass(a,"device-active"),SB.removeClass(l,"device-off"),SB.putText(SB.getByTag("em",l)[0],T("COOL")),t="")),d+=p.split("{{SUB_DEVICE_ID}}").join(m(f.label)),d=d.split("{{SUB_DEVICE_NAME}}").join(f.label),d=d.split("{{SUB_DEVICE_TEMP}}").join(Math.round(f.temp)),d=d.split("{{SUB_DEVICE_TARGET}}").join(Math.round(f.target)),d=d.split("{{SUB_DEVICE_HUMIDITY}}").join(Math.round(f.humidity)),f.state){case"cool":d=(d=d.split("{{DEVICE_STATE_COOL}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(T("COOL"));break;case"heat":d=(d=d.split("{{DEVICE_STATE_HEAT}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(T("HEAT"));break;default:d=(d=d.split("{{DEVICE_STATE_OFF}}").join(" device-off")).split("{{SUB_DEVICE_STATUS}}").join(T("OFF"))}!0===f.leaf&&(d=d.split("{{DEVICE_STATE_LEAF}}").join(" device-active")),d=(d=(d=(d=(d=(d=(d=i.presence&&"on"===i.presence?d.split("{{DEVICE_STATE_HOME}}").join(" device-active"):d.split("{{DEVICE_STATE_AWAY}}").join(" device-active")).split("{{DEVICE_STATE_COOL}}").join("")).split("{{DEVICE_STATE_HEAT}}").join("")).split("{{DEVICE_STATE_OFF}}").join("")).split("{{DEVICE_STATE_LEAF}}").join("")).split("{{DEVICE_STATE_HOME}}").join("")).split("{{DEVICE_STATE_AWAY}}").join("")}else"protect"===f.type&&(B="","ok"!==f.smoke&&(B+="smoke "),"ok"!==f.co&&(B+="co "),"ok"!==f.battery&&(B+="batt "),B&&(B+="device-active"),E=(E=(E=(E=(E+=u.split("{{SUB_DEVICE_STATE}}").join(B)).split("{{SUB_DEVICE_NAME}}").join(f.label)).split("{{SUB_DEVICE_SMOKE}}").join(f.smoke)).split("{{SUB_DEVICE_CO}}").join(f.co)).split("{{SUB_DEVICE_BATT}}").join(f.battery));d&&(d=(d=(d=S.replace("{{SUB_DEVICE_LIST}}",d)).replace("{{SUB_DEVICE_CLASS}}"," control-device-status")).replace("{{SUB_DEVICE_NAME}}",T("THERMOSTAT"))),E&&(E=(E=(E=S.replace("{{SUB_DEVICE_LIST}}",E)).replace("{{SUB_DEVICE_CLASS}}"," text-device-status")).replace("{{SUB_DEVICE_NAME}}",T("PROTECT")))}return t=t.replace("{{NEST_DYNAMIC}}",d+E)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.powerView=function(e,t,n,i,s,o){var r,a,c=s.blind,l=s.blinds,p=s.scene,u=s.scenes,S="",d="",E=0,B=0;if(i&&i.devices){for(E;E<i.devices.length;E+=1)r=i.devices[E],S=(S=(S+=c.split("{{SUB_DEVICE_ID}}").join(function(e){return e="object"==typeof SB?SB.util.encodeName(e):require(__dirname+"/../../lib/sharedUtil").util.encodeName(e)}(r.label))).split("{{SUB_DEVICE_PERCENTAGE}}").join(r.percentage)).split("{{SUB_DEVICE_NAME}}").join(r.label);if(S=S.split("{{i18n_SET_PERCENTAGE}}").join(function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"powerView"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"powerView",o)}("SET_PERCENTAGE")),S=l.split("{{POWERVIEW_BLINDS}}").join(S),i.scenes.length){for(B;B<i.scenes.length;B+=1)a=i.scenes[B],d=(d=(d+=p.split("{{SCENE_NAME_COMMAND}}").join(a.name)).split("{{SCENE_NAME}}").join(a.name)).split("{{SCENE_ICON}}").join(a.icon);d=u.split("{{POWERVIEW_SCENES}}").join(d)}}return t=t.split("{{POWERVIEW_DYNAMIC}}").join(S+d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.raspberryRemote=function(e,t,n,i,s){var o,r=s.switch,a=0,c="";if(i&&"object"==typeof i&&(o=i.devices))for(a in o)o.hasOwnProperty(a)&&(c=(c+=function(e){var t="";return t=r.split("{{SUB_DEVICE_ID}}").join(e.label.split(" ").join("+")),t=t.split("{{SUB_DEVICE_NAME}}").join(e.label)}(o[a])).split("{{SUB_DEVICE_CLASS}}").join(o[a].className||"fa-lightbulb-o"));return t.replace("{{RASPBERRY_REMOTE_DYNAMIC}}",c)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.roku=function(e,t,n,i,s){var o=s.list,r=0,a="";if(i)for(r in i)i.hasOwnProperty(r)&&(a=(a=(a+=o.split("{{APP_ID}}").join(i[r].id)).split("{{APP_IMG}}").join(i[r].cache)).split("{{APP_NAME}}").join(i[r].name));return t.replace("{{ROKU_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.rss=function(e,t,n,i,s){var o=s.item,r="",a=0,c="";if(n&&i)for(a;a<i.length;a+=1)c=i[a].description?i[a].description:i[a].text,r=(r=(r+=o.split("{{RSS_URL}}").join(i[a].url)).split("{{RSS_TITLE}}").join(i[a].title)).split("{{RSS_DESCRIPTION}}").join(c);return t=t.replace("{{RSS_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.smartthings=function(e,t,n,i,s,o){var r,a,c=s.action,l=s.static,p=s.group,u=0,S=0,d="",E="",B="",f=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"smartthings"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"smartthings",o)},m=function(e){var t="",n="",i="",s="",o="";switch(e.type){case"switch":t=c,i="fa-lightbulb-o";break;case"lock":t=c,i="fa-unlock-alt";break;case"contact":t=l,i="fa-columns";break;case"water":t=l,i="fa-tint";break;case"motion":t=l,i="fa-paw";break;case"presence":t=l,i="fa-male"}return e.peripheral&&e.peripheral.temp&&(s=" ("+e.peripheral.temp+"&deg;)"),e.peripheral&&"on"===e.peripheral.vibrate&&(o=" device-vibrate"),t&&(n=(n=(n=t.split("{{SUB_DEVICE_ID}}").join(e.label.split(" ").join("+"))).split("{{SUB_DEVICE_NAME}}").join(e.label+s)).split("{{SUB_DEVICE_CLASS}}").join(e.className||i),n="on"===e.state?(n=n.split("{{SUB_DEVICE_STATE}}").join(" device-active"+o)).split("{{SUB_DEVICE_STATUS}}").join(f("ACTIVE")):(n=n.split("{{SUB_DEVICE_STATE}}").join(o)).split("{{SUB_DEVICE_STATUS}}").join(f("INACTIVE"))),n};if(i&&"object"==typeof i&&"string"==typeof i.mode){if(E=i.mode,r=i.devices)if(i.groups){for(u in i.groups)if(i.groups.hasOwnProperty(u)){d+=p,B="";for(S in i.groups[u])i.groups[u].hasOwnProperty(S)&&(a=function(e,t){var n={},i=[],s=0,o=0;for(s in t)t.hasOwnProperty(s)&&(n=t[s]).label===e&&(i[o]=n,o+=1);return i}(i.groups[u][S],r))&&a[0]&&(B+=m(a[0]));d=(d=(d=d.split("{{GROUP_CLASS}}").join(function(e){return"group-"+(e="object"==typeof SB?SB.util.encodeName(e):require(__dirname+"/../../lib/sharedUtil").util.encodeName(e))}(u))).split("{{GROUP_TITLE}}").join(u)).split("{{SUB_DEVICE_LIST}}").join(B)}}else for(u in r)r.hasOwnProperty(u)&&(d+=m(r[u]));switch(E){case"Home":t=(t=t.split("{{DEVICE_STATE_HOME}}").join(" device-active")).split("{{HOME_STATUS}}").join(f("ACTIVE"));break;case"Away":t=(t=t.split("{{DEVICE_STATE_AWAY}}").join(" device-active")).split("{{AWAY_STATUS}}").join(f("ACTIVE"));break;case"Night":t=(t=t.split("{{DEVICE_STATE_NIGHT}}").join(" device-active")).split("{{NIGHT_STATUS}}").join(f("ACTIVE"))}}return t=t.split("{{DEVICE_STATE_HOME}}").join(""),t=t.split("{{DEVICE_STATE_AWAY}}").join(""),t=t.split("{{DEVICE_STATE_NIGHT}}").join(""),t=t.split("{{HOME_STATUS}}").join(f("INACTIVE")),t=t.split("{{AWAY_STATUS}}").join(f("INACTIVE")),(t=t.split("{{NIGHT_STATUS}}").join(f("INACTIVE"))).replace("{{SMARTTHINGS_DYNAMIC}}",d)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.sports=function(e,t,n,i,s,o){var r=s.league,a=s.game,c=0,l=0,p={},u={},S="",d="",E="",B="",f="",m="",T="",C=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"sports"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"sports",o)};if(n&&i)for(c in i)if(i.hasOwnProperty(c)){for(p=i[c],T="",l=0;l<p.games.length;l+=1)u=p.games[l],S=C("TITLE").split("{{AWAY}}").join(u.away.title).split("{{HOME}}").join(u.home.title),E=u.away.winner?" winner":"",d=u.home.winner?" winner":"",B=u.away.winner?" ("+C("WINNER")+")":"",f=u.home.winner?" ("+C("WINNER")+")":"",T=(T=(T=(T=(T=(T=(T=(T=(T=(T=(T=(T=(T=(T=(T+=a.split("{{GAME_LINK}}").join(u.url||"#")).split("{{GAME_TITLE}}").join(S)).split("{{GAME_AWAY_WINNER_CLASS}}").join(E)).split("{{GAME_AWAY_WINNER}}").join(B)).split("{{GAME_AWAY_TEAM}}").join(u.away.title)).split("{{GAME_AWAY_IMAGE}}").join(u.away.image)).split("{{GAME_AWAY_SCORE}}").join(u.away.score)).split("{{GAME_HOME_WINNER_CLASS}}").join(d)).split("{{GAME_HOME_WINNER}}").join(f)).split("{{GAME_HOME_TEAM}}").join(u.home.title)).split("{{GAME_HOME_IMAGE}}").join(u.home.image)).split("{{GAME_HOME_SCORE}}").join(u.home.score)).split("{{GAME_TIME}}").join(function(e){return"object"==typeof SB&&"object"==typeof SB.util?SB.util.displayTime(e,C):require(__dirname+"/../../lib/sharedUtil").util.displayTime(e,C)}(u.time))).split("{{GAME_STATUS}}").join((u.status||"").toLowerCase())).split("{{GAME_STATE}}").join(C(u.status));m=(m+=r.split("{{LEAGUE_NAME}}").join(p.title)).split("{{GAME_LIST}}").join(T)}return t.replace("{{SPORTS_DYNAMIC}}",m)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.stocks=function(e,t,n,i,s,o){var r=s.list,a=0,c="",l="",p="",u="",S=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"stocks"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"stocks",o)};if(i)for(a in i)i.hasOwnProperty(a)&&(l="neutral",p="arrows-h",u=S("NEUTRAL"),i[a].dayChangeValue&&(0===i[a].dayChangeValue.indexOf("+")?(l="gain",p="arrow-up",u=S("GAIN")):0===i[a].dayChangeValue.indexOf("-")&&(l="loss",p="arrow-down",u=S("LOSS"))),c=(c=(c=(c=(c=(c=(c+=r.split("{{STOCK_CHANGE}}").join(l)).split("{{STOCK_ARROW}}").join(p)).split("{{STOCK_DIRECTION}}").join(u)).split("{{STOCK_NAME}}").join(i[a].name)).split("{{STOCK_PRICE}}").join(i[a].price)).split("{{STOCK_CHANGE_VALUE}}").join(i[a].dayChangeValue)).split("{{STOCK_CHANGE_PERCENT}}").join(i[a].dayChangePercent));return t.replace("{{STOCKS_DYNAMIC}}",c)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.traffic=function(e,t,n,i,s){var o=s.list,r=0,a="";if(i)for(r in i)i.hasOwnProperty(r)&&(a=(a+=o.split("{{CAM_IMG}}").join(i[r].image)).split("{{CAM_NAME}}").join(i[r].title));return t.replace("{{TRAFFIC_DYNAMIC}}",a)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.travis=function(e,t,n,i,s){var o=s.build,r="",a="",c="",l=0;if(n&&i)for(l;l<i.length;l+=1)a="",c="","created"===i[l].state||"started"===i[l].state?a="cogs":"ok"===i[l].status?a="check":"err"===i[l].status&&(a="times"),i[l].duration&&(c=" ("+i[l].duration+"s)"),r=(r=(r=(r=(r+=o.split("{{TRAVIS_URL}}").join(i[l].url)).split("{{TRAVIS_ICON}}").join(a)).split("{{TRAVIS_STATE}}").join(i[l].status)).split("{{TRAVIS_DURATION}}").join(c)).split("{{TRAVIS_DESCRIPTION}}").join(i[l].label);return t=t.replace("{{TRAVIS_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.twitter=function(e,t,n,i,s){var o=s.tweet,r="",a=0;if(n&&i)for(a;a<i.length;a+=1)r=(r=(r+=o.split("{{TWEET_TEXT}}").join(i[a].text)).split("{{TWEET_URL}}").join(i[a].url)).split("{{TWEET_AUTHOR}}").join(i[a].author);return t=t.replace("{{TWITTER_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.weather=function(e,t,n,i,s,o){var r,a,c=s.forecast,l=0,p="";if(r=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"weather"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"weather",o)},a=function(e){var t="snowflake-o",n={0:"warning",1:"warning",2:"warning",3:"bolt",4:"bolt",5:t,6:t,7:t,8:t,9:"tint",10:"tint",11:"tint",12:"tint",13:t,14:t,15:t,16:t,17:t,18:t,19:"fire",20:"fire",21:"fire",22:"fire",23:"flag",24:"flag",25:t,26:"cloud",27:"cloud",28:"cloud",29:"cloud",30:"cloud",31:"moon-o",32:"sun-o",33:"moon-o",34:"sun-o",35:t,36:"sun-o",37:"bolt",38:"bolt",39:"bolt",40:"tint",41:t,42:t,43:t,44:"cloud",45:"bolt",46:t,47:"bolt"};return e=parseInt(e,10),n[e]||"question"},i&&i.code){t=(t=(t=(t=t.replace("{{WEATHER_ICON}}",a(i.code))).replace("{{WEATHER_CURRENT}}",i.city+" "+r("CURRENT")+": "+i.temp+"&deg; "+i.text)).replace("{{WEATHER_SUNRISE}}",i.sunrise)).replace("{{WEATHER_SUNSET}}",i.sunset);for(l in i.forecast)i.forecast.hasOwnProperty(l)&&(p=(p=(p=(p=(p+=c.split("{{WEATHER_ICON}}").join(a(i.forecast[l].code))).split("{{WEATHER_DAY}}").join(i.forecast[l].day+":")).split("{{WEATHER_TEXT}}").join(i.forecast[l].text)).split("{{WEATHER_HIGH}}").join(i.forecast[l].high+"&deg;")).split("{{WEATHER_LOW}}").join(i.forecast[l].low+"&deg;"))}else t=(t=(t=t.replace("{{WEATHER_CURRENT}}",r("UNAVAILABLE"))).replace("{{WEATHER_SUNRISE}}","")).replace("{{WEATHER_SUNSET}}",""),"string"==typeof i&&(p=i);return t.replace("{{WEATHER_DYNAMIC}}",p)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.website=function(e,t,n,i){var s="";return i&&i.source&&(s=i.source),t.replace("{{WEBSITE_DYNAMIC}}",s)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.wemo=function(e,t,n,i,s,o){var r,a=s.switch,c=s.group,l=0,p=0,u="",S="",d="",E=function(e){return e="object"==typeof SB&&"object"==typeof SB.util?SB.util.translate(e,"wemo"):require(__dirname+"/../../lib/sharedUtil").util.translate(e,"wemo",o)},B=function(e){var t="";return S&&(S+="device-active"),t=a.split("{{SUB_DEVICE_ID}}").join(e.label.split(" ").join("+")),t=t.split("{{SUB_DEVICE_NAME}}").join(e.label),t=t.split("{{SUB_DEVICE_CLASS}}").join(e.className||"fa-lightbulb-o"),t="on"===e.state?(t=t.split("{{SUB_DEVICE_STATE}}").join(" device-active")).split("{{SUB_DEVICE_STATUS}}").join(E("ACTIVE")):"off"===e.state?(t=t.split("{{SUB_DEVICE_STATE}}").join("")).split("{{SUB_DEVICE_STATUS}}").join(E("INACTIVE")):(t=t.split("{{SUB_DEVICE_STATE}}").join(" device-off")).split("{{SUB_DEVICE_STATUS}}").join(E("INACTIVE"))};if(i&&i.devices){if(i.groups){for(l in i.groups)if(i.groups.hasOwnProperty(l)){u+=c,d="";for(p in i.groups[l])i.groups[l].hasOwnProperty(p)&&(r=function(e,t){var n={},i=0;for(i in t)if(t[i].label===e){n=t[i];break}return n}(i.groups[l][p],i.devices))&&(d+=B(r));u=(u=(u=u.split("{{GROUP_CLASS}}").join(function(e){return e="object"==typeof SB?SB.util.encodeName(e):require(__dirname+"/../../lib/sharedUtil").util.encodeName(e)}(l))).split("{{GROUP_TITLE}}").join(l)).split("{{SUB_DEVICE_LIST}}").join(d)}}else for(l in i.devices)i.devices.hasOwnProperty(l)&&(u+=B(i.devices[l]));u&&(u=u.replace("{{SUB_DEVICE_CLASS}}"," text-device-status"))}return t.replace("{{WEMO_DYNAMIC}}",u)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.xbmc=function(e,t,n,i,s){var o=s.current,r="";return i&&i.current&&(r=o.split("{{DEVICE_CURRENT}}").join(i.current)),t.replace("{{XBMC_DYNAMIC}}",r)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(e){"use strict";e.util={version:20151215,replaceAll:function(e,t,n){var i=e;return"string"==typeof e&&(i=e.replace(new RegExp(t,"g"),n)),i},stripTags:function(e){return"string"==typeof e?e.replace(/(<([^>]+)>)/gi,""):e},stripControl:function(e){return"string"==typeof e?e.replace(new RegExp("[\0-]+","g"),""):e},sanitize:function(t){return e.util.stripTags(e.util.stripControl(t))},encodeName:function(e){return e&&"string"==typeof e&&(e=e.replace(/[\s!@#$%^&*()"'\\<>,;.:/+]/g,"_").toLowerCase()),e},translate:function(e,t,n){var i,s="";return e&&"string"==typeof e?(e=e.toUpperCase(),"object"==typeof SB?(n=document.documentElement.getAttribute("lang"),i=function(e,t){var n=SB.getByClass(t,SB.getByTag("main")[0],"section")[0];return e=e.replace("{{i18n_","").replace("}}",""),n.dataset&&n.dataset["string"+e.charAt(0)+e.substr(1).toLowerCase()]?e=n.dataset["string"+e.charAt(0)+e.substr(1).toLowerCase()]:SB.spec.strings[e]&&(e=SB.spec.strings[e]),e}):i=require(__dirname+"/translate").translate,s=i("{{i18n_"+e+"}}",t,n)):s=e,s},arrayList:function(t,n,i){var s="",o=0;for(o;o<t.length;o+=1)o&&(o===t.length-1?s=s+" "+e.util.translate("AND",n,i)+" ":s+=", "),s+=t[o];return s},displayRelativeTime:function(e){var t,n={day:86400,hour:3600,minute:60,second:1},i={day:"00",hour:"00",minute:"00",second:"00"};for(t in n)e>=n[t]&&(i[t]=Math.floor(e/n[t]),i[t]<10&&(i[t]="0"+i[t]),e-=i[t]*n[t]);return i.day+" "+i.hour+":"+i.minute+":"+i.second},displayTime:function(e,t,n,i){var s=i||new Date(e),o=s.getDate(),r=s.getDay(),a={0:"sun",1:"mon",2:"tue",3:"wed",4:"thur",5:"fri",6:"sat"},c=s.getHours(),l=s.getMinutes(),p=t("am"),u="";switch(c>12&&(c-=12,p=t("pm")),c=0===c?12:c,l<10&&(l="0"+l),r=t(a[r]),n){case"long":u=r+" "+o+" @ "+c+":"+l+p;break;default:u=r+" @ "+c+":"+l+p}return u}}}("undefined"==typeof exports?this.SB:exports);